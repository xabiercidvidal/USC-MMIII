

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Cambio de coordenadas e regra da cadea &#8212; Métodos Matemáticos III - USC</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/tderivadas_coordenadas_cadea';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Gradiente, matriz xacobiana, funcións diferenciables" href="tderivadas_gradiante_xacobiana.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introdución
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Notas prácticas</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../notas_practicas.html">Como acceder ás notas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../run_cloud.html">Executar os apuntes na nube</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Derivadas en varias dimensións</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="tderivadas_introducion.html">Cuestións iniciais</a></li>
<li class="toctree-l1"><a class="reference internal" href="tderivadas_funcion_escalar_vectorial.html">Funcións escalares, gráficos, conxuntos de nivel e funcións vectoriais.</a></li>
<li class="toctree-l1"><a class="reference internal" href="tderivadas_limites_continuidade.html">Límite e continuidade das funcións escalares e vectoriais</a></li>
<li class="toctree-l1"><a class="reference internal" href="tderivadas_parametrizacion_linhas_superficies.html">Parametrización de curvas e superficies</a></li>
<li class="toctree-l1"><a class="reference internal" href="tderivadas_direccional_diferencial.html">Derivadas direccionais e funcións derivables</a></li>
<li class="toctree-l1"><a class="reference internal" href="tderivadas_gradiante_xacobiana.html">Gradiente, matriz xacobiana, funcións diferenciables</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Cambio de coordenadas e regra da cadea</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/xabiercidvidal/USC-MMIII/main?urlpath=tree/notebooks/tderivadas_coordenadas_cadea.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/xabiercidvidal/USC-MMIII/blob/main/notebooks/tderivadas_coordenadas_cadea.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/xabiercidvidal/USC-MMIII" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/xabiercidvidal/USC-MMIII/issues/new?title=Issue%20on%20page%20%2Fnotebooks/tderivadas_coordenadas_cadea.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/tderivadas_coordenadas_cadea.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Cambio de coordenadas e regra da cadea</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#obxectivos">Obxectivos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cambio-de-variables">Cambio de variables</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cambios-de-coordenadas">Cambios de coordenadas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matriz-de-cambio-de-coordenadas-xacobianas">Matriz de cambio de coordenadas xacobianas</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-regra-da-cadea">A regra da cadea</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#teorema-da-regra-da-cadea">Teorema da regra da cadea</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apendice">Apéndice</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="cambio-de-coordenadas-e-regra-da-cadea">
<h1>Cambio de coordenadas e regra da cadea<a class="headerlink" href="#cambio-de-coordenadas-e-regra-da-cadea" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Última execución &#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">asctime</span><span class="p">()</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Última execución  Fri Feb 23 16:08:33 2024
</pre></div>
</div>
</div>
</div>
<section id="obxectivos">
<h2>Obxectivos<a class="headerlink" href="#obxectivos" title="Permalink to this heading">#</a></h2>
<p>Aprende a facer cambios de coordenadas</p>
<p>Mostra a regra da cadea e algúns usos.</p>
<p><em>Nota</em></p>
<p>Para que este notebook funcione en colab, precisamos <a href = "https://www.dropbox.com/scl/fi/wwz2w43kqj0s38gm87roj/graph_utils.py?rlkey=rppkwu9tmbnnsojezzj69p1r0&dl=1"> graph_utils.py </a>. Podes descargalo premendo na ligazón, e subilo a colab:</p>
<a class="reference internal image-reference" href="https://www.dropbox.com/scl/fi/b35vcated0f9lwrw4jy01/colab_upload.jpg?rlkey=l1ag15r0ovkg2dsefze117k1y&amp;raw=1"><img alt="https://www.dropbox.com/scl/fi/b35vcated0f9lwrw4jy01/colab_upload.jpg?rlkey=l1ag15r0ovkg2dsefze117k1y&amp;raw=1" class="align-center" src="https://www.dropbox.com/scl/fi/b35vcated0f9lwrw4jy01/colab_upload.jpg?rlkey=l1ag15r0ovkg2dsefze117k1y&amp;raw=1" style="width: 200px;" /></a>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># general imports</span>
<span class="c1"># general imports</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="o">%</span><span class="k">reload_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="c1"># numpy and matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">graph_utils</span> <span class="k">as</span> <span class="nn">gf</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="cambio-de-variables">
<h2>Cambio de variables<a class="headerlink" href="#cambio-de-variables" title="Permalink to this heading">#</a></h2>
<p>A seguinte función é o potencial dunha carga eléctrica, <span class="math notranslate nohighlight">\(q\)</span> no espazo:</p>
<div class="math notranslate nohighlight">
\[
 V(x, y, z) = k \frac{q}{\sqrt{x^2 + y^2 + z^2}}
 \]</div>
<p>Sabemos que o potencial é radial, o que só depende da distancia á carga, <span class="math notranslate nohighlight">\(r = \sqrt{x^2 + y^2 + z^2}\)</span>.</p>
<p>Podemos expresar o potencial en <em>coordenadas cartesianas</em> , como na ecuación anterior, pero tamén, máis simplemente, en <em>coordenadas esféricas</em> , onde a variable <span class="math notranslate nohighlight">\(r\)</span> é a distancia á orixe, así:</p>
<div class="math notranslate nohighlight">
\[
 V(r) = k \frac{q}{r}
 \]</div>
<p>Neste caso só depende de <span class="math notranslate nohighlight">\(r\)</span></p>
<p>Na sección de parametrización da superficie, vimos que podíamos dar a parede dun cilindro de raio <span class="math notranslate nohighlight">\(r\)</span> e altura infinita como:</p>
<div class="math notranslate nohighlight">
\[
 \sigma(\phi, z) = ( r \cos \phi, r \sin \phi, z)
 \]</div>
<p>Onde o raio, <span class="math notranslate nohighlight">\(r\)</span>, era unha constante. Se agora consideramos que <span class="math notranslate nohighlight">\(r\)</span> pode tomar todos os valores de <span class="math notranslate nohighlight">\([0, \infty)\)</span>. O conxunto de todas as <em>tapas</em> de cilindros, <em>cobre</em> ou <em>mapea</em>, o espazo tridimensional.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phi_range</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">z_range</span>   <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span>      <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">funx</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">phi</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="n">r</span>  <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="n">funy</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">phi</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="n">r</span>  <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="n">funz</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">phi</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="n">z</span>
<span class="n">gf</span><span class="o">.</span><span class="n">wfsurface</span><span class="p">(</span><span class="n">funx</span><span class="p">,</span> <span class="n">funy</span><span class="p">,</span> <span class="n">funz</span><span class="p">,</span> <span class="n">phi_range</span><span class="p">,</span> <span class="n">z_range</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/261364d945b6d941ccc546eaf7880c52f5e14f3831731e32f0e8dd7b32a75153.png" src="../_images/261364d945b6d941ccc546eaf7880c52f5e14f3831731e32f0e8dd7b32a75153.png" />
</div>
</div>
<p>Podemos dar todos os puntos, <span class="math notranslate nohighlight">\((x, y, z)\)</span>, dun espazo <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span> en <em>coordenadas cilíndricas</em> , onde expresamos as coordenadas <span class="math notranslate nohighlight">\((x, y)\)</span> por, <span class="math notranslate nohighlight">\((r, \phi)\)</span> onde <span class="math notranslate nohighlight">\(r\)</span> é a distancia á orixe e <span class="math notranslate nohighlight">\(\phi\)</span> o ángulo co eixe <span class="math notranslate nohighlight">\(x\)</span>. Mentres mantemos a coordenada <span class="math notranslate nohighlight">\(z\)</span>. Isto é:</p>
<div class="math notranslate nohighlight">
\[
 (r, \phi, z) \to (x, y, z)
 \]</div>
<p>Onde:</p>
<div class="math notranslate nohighlight">
\[
 x = r \cos \phi, \;\,
 y = r \sin \phi, \;\,
 z = z
 \]</div>
<p>O dominio en cilíndricas é <span class="math notranslate nohighlight">\(r \in [0, \infty)\)</span>, <span class="math notranslate nohighlight">\(\phi \in [0, 2 \pi)\)</span>, mentres que <span class="math notranslate nohighlight">\(z\)</span> é todo <span class="math notranslate nohighlight">\(\mathbb{R}\)</span>.</p>
<p><em>Exercicio</em> : Cal é a transformación inversa, de cartesianas a cilíndricas?</p>
<p>A transformación inversa, de <em>cilíndricas</em> a <em>cartesianas,</em> vén dada por:</p>
<div class="math notranslate nohighlight">
\[
 r = \sqrt{x^2 + y^2}, \, \cos \phi = \frac{x}{\sqrt{x^2 + y^2}}, \;\, z = z
 \]</div>
<p>Se lembras, tamén parametrizamos unha esfera de raio <span class="math notranslate nohighlight">\(r\)</span>:</p>
<div class="math notranslate nohighlight">
\[
 \sigma(\theta, \phi) = (r \cos \phi \sin \theta, \; r \sin \phi \sin \theta, \; r \cos \theta)
 \]</div>
<p>Considerando agora todas as esferas posibles, é dicir, variando <span class="math notranslate nohighlight">\(r\)</span> de <span class="math notranslate nohighlight">\([0, \infty)\)</span> podemos volver cubrir todo o espazo tridimensional, <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theta_range</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>    <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">20</span>
<span class="n">phi_range</span>   <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">2.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">20</span>
<span class="n">r</span> <span class="o">=</span> <span class="mf">1.</span>
<span class="n">funx</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="p">:</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">funy</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="p">:</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">funz</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span> <span class="p">:</span> <span class="n">r</span>               <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">gf</span><span class="o">.</span><span class="n">wfsurface</span><span class="p">(</span><span class="n">funx</span><span class="p">,</span> <span class="n">funy</span><span class="p">,</span> <span class="n">funz</span><span class="p">,</span> <span class="n">theta_range</span><span class="p">,</span> <span class="n">phi_range</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/0ca2e9840e118dfe24919b42583b8d6e3d1dbed0073a3f3203bd225c5a35c61e.png" src="../_images/0ca2e9840e118dfe24919b42583b8d6e3d1dbed0073a3f3203bd225c5a35c61e.png" />
</div>
</div>
<p><em>As coordenadas esféricas</em> permítennos asociar calquera punto do espazo, <span class="math notranslate nohighlight">\((x, y, z)\)</span>, de <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span>, a un raio, <span class="math notranslate nohighlight">\(r\)</span>, a distancia do punto desde a orixe, o ángulo <span class="math notranslate nohighlight">\( \theta\)</span> que forma o punto co eixe <span class="math notranslate nohighlight">\(z\)</span>, e o ángulo que forma a proxección do punto no plano <span class="math notranslate nohighlight">\((x, y)\)</span> no eixe <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>O cambio a esféricas vén dado por:</p>
<div class="math notranslate nohighlight">
\[
 x = r \cos \phi \sin \theta, \;\, y = r \sin \phi \sin \theta, \;\, z = r \cos \theta
 \]</div>
<p>Onde o rango de <span class="math notranslate nohighlight">\(\theta\)</span> é <span class="math notranslate nohighlight">\([0, \pi]\)</span> e o de <span class="math notranslate nohighlight">\(\phi\)</span> é <span class="math notranslate nohighlight">\([0, 2 \pi)\)</span>.</p>
<p><a class="reference internal" href="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4f/3D_Spherical.svg/800px-3D_Spherical.svg.png"><img alt="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4f/3D_Spherical.svg/800px-3D_Spherical.svg.png" class="align-center" src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/4f/3D_Spherical.svg/800px-3D_Spherical.svg.png" style="width: 400px;" /></a></p>
<p>Con <span class="math notranslate nohighlight">\(\theta = 0, \pi\)</span> damos os polos da esfera, con <span class="math notranslate nohighlight">\(\theta = \pi/2\)</span> o seu ecuador. Situado a unha altura da esfera, o ángulo <span class="math notranslate nohighlight">\(\phi\)</span>, permítenos viaxar ao seu redor nun círculo de raio <span class="math notranslate nohighlight">\(r \sin \theta\)</span> en sentido antihorario (visto desde arriba). No ecuador, por suposto, cun raio <span class="math notranslate nohighlight">\(r\)</span>.</p>
<p><em>Exercicio:</em> Cal é o cambio inverso que nos leva de cartesianas a esféricas?</p>
<p>O cambio inverso de cartesianas a esféricas vén dado por:</p>
<div class="math notranslate nohighlight">
\[
 r = \sqrt{x^2 + y^2 + z^2}, \;\, \cos \phi = \frac{x}{\sqrt{x^2 + y^2}}, \;\, \cos \theta = \frac{z}{\sqrt{x^2 + y^2 + z^2}}
 \]</div>
<section id="cambios-de-coordenadas">
<h3>Cambios de coordenadas<a class="headerlink" href="#cambios-de-coordenadas" title="Permalink to this heading">#</a></h3>
<p>Os cambios de coordenadas son polo tanto funcións vectoriais, <span class="math notranslate nohighlight">\({\bf f}: \mathbb{R}^n \to \mathbb{R}^n\)</span>, diferenciables, bixectivas (agás algún punto singular) e que admiten tamén unha función inversa, tamén diferenciable.</p>
<p><em>Nota:</em> unha función bixectiva asocia cada punto do espazo inicial cun punto diferente do espazo da imaxe, e cada punto do espazo da imaxe ten un punto no inicial. Ten en conta que hai algúns puntos singulares que non cumpren con isto, como os polos no cambio a esférico e cando <span class="math notranslate nohighlight">\(r = 0\)</span> para ambos. Non obstante, isto non nos impide cubrir completamente o espazo <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span></p>
</section>
<section id="matriz-de-cambio-de-coordenadas-xacobianas">
<h3>Matriz de cambio de coordenadas xacobianas<a class="headerlink" href="#matriz-de-cambio-de-coordenadas-xacobianas" title="Permalink to this heading">#</a></h3>
<p>Imos calcular a matriz xacobiana dos cambios de coordenadas a cilíndricas.</p>
<p>A función vectorial do cambio de coordenadas a cilíndricas é:</p>
<div class="math notranslate nohighlight">
\[
{\bf x}(r, \phi, z) \; =  \, \left( r \cos \phi, \, r \sin \phi, \,  z \right)
\]</div>
<p>E a súa matriz xacobiana:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
{\bf Dx}(r, \phi, z) = \left( \begin{array}{ccc} 
\cos \phi &amp; - r \sin \phi &amp; 0 \\
\sin \phi &amp;   r \cos \phi &amp; 0 \\
        0 &amp;             0 &amp; 1 
\end{array} \right)
\end{split}\]</div>
<p>A función vectorial do cambio de coordenadas a esféricas é:</p>
<div class="math notranslate nohighlight">
\[
{\bf x}(r, \phi, \theta) \; =  \, \left( r \cos \phi \sin \theta, \, r \sin \phi \sin \theta, \,  r \cos \theta \right)
\]</div>
<p>E a súa matriz xacobiana:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
{\bf Dx}(r, \phi, \theta) = \left( \begin{array}{ccc} 
\cos \phi \sin \theta &amp; - r \sin \phi \sin \theta &amp;  r \cos \phi \cos \theta \\
\sin \phi \sin \theta &amp;   r \cos \phi \sin \theta &amp;  r \sin \phi \cos \theta \\
          \cos \theta &amp;                         0 &amp; -r \sin \theta  
\end{array} \right)
\end{split}\]</div>
</section>
</section>
<section id="a-regra-da-cadea">
<h2>A regra da cadea<a class="headerlink" href="#a-regra-da-cadea" title="Permalink to this heading">#</a></h2>
<p>En certos casos temos unha función vectorial, <span class="math notranslate nohighlight">\({\bf f}({\bf x})\)</span>, de <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span>, da que coñecemos a súa derivada, <span class="math notranslate nohighlight">\({\bf Df}({\bf x})\)</span>, e preguntámonos cal será a súa derivada en coordenadas cilíndricas ou esféricas.</p>
<p>Existe unha relación sinxela entre a derivada da función nas novas coordenadas e a derivada nas coordenadas cartesianas?</p>
<p>A resposta é a regra da cadea, que nos di que a nova derivada é o produto da derivada da primeira función e a derivada, a matriz xacobiana, do cambio de variables:</p>
<p>Sexa <span class="math notranslate nohighlight">\({\bf f}({\bf x)}\)</span> con derivada, <span class="math notranslate nohighlight">\({\bf Df}({\bf x})\)</span> en cartesianas e <span class="math notranslate nohighlight">\({\bf x}({\bf u})\)</span> un cambio de coordenadas, con matriz xacobiana, <span class="math notranslate nohighlight">\({\bf Dx}({\bf u})\)</span>. A función composta, <span class="math notranslate nohighlight">\({\bf h} ({\bf u}) = {\bf f} \circ { \bf x}({\bf u}) = {\bf f}\left({\bf x }({\bf u}) \right)\)</span>, ten como derivada:</p>
<div class="math notranslate nohighlight">
\[
 {\bf Dh}({\bf u}) \; = \; {\bf Df} \left({\bf x( {\bf u})} \right) \; {\bf Dx}({\bf u})
 \]</div>
<p>O produto dos derivadas!</p>
<section id="teorema-da-regra-da-cadea">
<h3>Teorema da regra da cadea<a class="headerlink" href="#teorema-da-regra-da-cadea" title="Permalink to this heading">#</a></h3>
<p><em>Teorema</em>: Sexa <span class="math notranslate nohighlight">\({\bf g}: A \subset \mathbb{R}^n \to \mathbb{R}^m\)</span>, <span class="math notranslate nohighlight">\(A\)</span> un conxunto aberto de <span class="math notranslate nohighlight">\(\mathbb{R}^n\)</span>, e <span class="math notranslate nohighlight">\({\bf f}: B \subset \mathbb{R}^m \to \mathbb{R}^p\)</span>, <span class="math notranslate nohighlight">\(B\)</span> un conxunto aberto de <span class="math notranslate nohighlight">\(\mathbb{R}^m\)</span>, onde o dominio de <span class="math notranslate nohighlight">\({\bf f}\)</span> se inclúe no intervalo de <span class="math notranslate nohighlight">\({\bf g}\)</span>. Se <span class="math notranslate nohighlight">\({\bf g}\)</span> é diferenciable nun punto <span class="math notranslate nohighlight">\({\bf x}\)</span> interior a <span class="math notranslate nohighlight">\(A\)</span> e <span class="math notranslate nohighlight">\({\bf f}\)</span> o é no punto <span class="math notranslate nohighlight">\({\bf g}({\bf x})\)</span>, entón, a función de composición <span class="math notranslate nohighlight">\({\bf h} = {\bf f} \circ {\bf g}: A \subset \mathbb{R}^n \to \mathbb{R}^p\)</span>, definida como: <span class="math notranslate nohighlight">\({\bf h}({\bf x})= {\bf f} \circ {\bf g} ({\bf x}) = {\bf f} \left( {\bf g}({\bf x}) \right)\)</span>, é diferenciable en <span class="math notranslate nohighlight">\({\bf x}\)</span> e o seu diferencial é:</p>
<div class="math notranslate nohighlight">
\[
{\bf D}({\bf f} \circ {\bf g})({\bf x}) = {\bf Df}\left( {\bf g}({\bf x}) \right) \, {\bf Dg}({\bf x}) 
\]</div>
<p><em>Exemplo</em> : coas funcións: <span class="math notranslate nohighlight">\(f(x,y)= x^2+y^2\)</span> e <span class="math notranslate nohighlight">\({\bf g}(r,\theta) = (r\cos \theta, r \sin \theta)\)</span> , verifica a regra da cadea para a función composta, <span class="math notranslate nohighlight">\(h(r,\theta) = (f \circ {\bf g})(r,\theta)\)</span>.</p>
<p><em>solución:</em>
Como produto de derivadas:</p>
<div class="math notranslate nohighlight">
\[
\nabla f (x,y)  = (2x, \, 2y) \Rightarrow \nabla f (r,\theta)  = (2 r \cos \theta, \, 2 r \sin \theta) 
\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
{\bf Dg}(r,\theta)  = \left( \begin{array}{cc} 
\cos \theta &amp; - r \sin \theta \\
 \sin \theta &amp; r \cos \theta
\end{array} \right) 
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\nabla f (r,\theta) \, {\bf Dg} (r,\theta)  =  (2 r \cos \theta, 2 r \sin \theta) \, \left(
\begin{array}{cc} 
\cos \theta &amp; - r \sin \theta \\
 \sin \theta &amp; r \cos \theta
\end{array} \right) = (2r,0) \\
\end{split}\]</div>
<p>Agora expresando a función inicial en polares:</p>
<div class="math notranslate nohighlight">
\[
 h (r,\theta)  = r^2 
\]</div>
<div class="math notranslate nohighlight">
\[
\nabla h (r,\theta) = (2r,0)
\]</div>
<p><em>Exercicio</em> : Verifica a regra da cadea para a función composta
<span class="math notranslate nohighlight">\(h = f \circ {\bf g}: \mathbb{R}^3 \to \mathbb{R}\)</span> dado por <span class="math notranslate nohighlight">\(g:\mathbb{R}^3 \to \mathbb{R}^3\)</span>, <span class="math notranslate nohighlight">\({\bf g}(x,y,z)=(x^2y,y^2,e^{-xz})\)</span> e <span class="math notranslate nohighlight">\(f:\mathbb{R}^3\to\mathbb{R}\)</span> , <span class="math notranslate nohighlight">\(f(u,v,w)=u^2+v^2-w\)</span>.</p>
<p><em>Solución</em>:</p>
<p>Substituíndo:</p>
<div class="math notranslate nohighlight">
\[
h(x,y,z)  = (x^2y)^2+(y^2)^2-e^{-xz} 
\]</div>
<div class="math notranslate nohighlight">
\[
\nabla h(x,y,z)  =(4x^3y^2+ze^{-xz},2x^4y+4y^3,xe^{-xz}) 
\]</div>
<p>Aplicando a regra da cadea:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
{\bf Dg}(x,y,z)  = \left( \begin{array}{ccc}
2xy &amp; x^2 &amp; 0 \\
0 &amp; 2y &amp; 0 \\
-ze^{-xz} &amp; 0 &amp; -xe^{-xz} \\ \end{array} \right) 
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[
\nabla f(u,v,w) = (2u,2v,-1) \Rightarrow \nabla f(x,y,z) = (2x^2y,2y^2,-1) 
\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\nabla f(x,y,z) \, {\bf Dg}(x,y,z)  =  (2x^2y,2y^2,-1) \, \left( \begin{array}{ccc}
2xy &amp; x^2 &amp; 0 \\
0 &amp; 2y &amp; 0 \\
-ze^{-xz} &amp; 0 &amp; -xe^{-xz} \\ \end{array} \right)  \\
= (4x^3y^2+ze^{-xz},2x^4y+4y^3,xe^{-xz})
\end{split}\]</div>
<p><em>Exemplo</em> de uso da regra da cadea:</p>
<p><strong>Plano tanxente a un conxunto de nivel dunha función <span class="math notranslate nohighlight">\(f(x, y, z)\)</span></strong> .</p>
<p>Sexa unha función escalar, <span class="math notranslate nohighlight">\(f(x, y, z)\)</span> de <span class="math notranslate nohighlight">\(\mathbb{R}^3 \to \mathbb{R}\)</span>, e un conxunto de nivel, c, <span class="math notranslate nohighlight">\(f(x, y, z) = c\)</span>, e unha traxectoria, parametrizada, de puntos dese conxunto de nivel  <span class="math notranslate nohighlight">\({\bf r}(t)\)</span>, con <span class="math notranslate nohighlight">\(t \in [t_0, t_e]\)</span>, onde en <span class="math notranslate nohighlight">\(t = t_0\)</span> , dános <span class="math notranslate nohighlight">\({\bf r}(t_0) = (x_0, y_0, z_0)\)</span>.</p>
<p>Se facemos a función composta <span class="math notranslate nohighlight">\(h = f \circ \ {\bf r} (t)\)</span>, que é simplemente unha función real unidimensional, <span class="math notranslate nohighlight">\(h(t) = f({\bf r}(t)), \;
\mathbb{R} \to \mathbb{R}\)</span>.</p>
<p>Neste caso dado, os puntos de <span class="math notranslate nohighlight">\({\bf r}(t)\)</span> están no conxunto de nivel <span class="math notranslate nohighlight">\(f(x, y, z) = c\)</span>, a función sempre vale <span class="math notranslate nohighlight">\(c\)</span> e, polo tanto, a súa derivada é nula.</p>
<div class="math notranslate nohighlight">
\[
 \frac{\mathrm{d}h(t_0)}{\mathrm{d}t} = 0.
 \]</div>
<p>Que pola regra da cadea é o mesmo que:</p>
<div class="math notranslate nohighlight">
\[
\nabla f \left({\bf r}(t_0) \right) \, {\bf r}'(t_0) = 0
\]</div>
<p>Que corresponde a dous vectores ortogonais. O primeiro é o gradiente de <span class="math notranslate nohighlight">\(f(x, y, z)\)</span> en <span class="math notranslate nohighlight">\((x_0, y_0, z_0)\)</span>, é dicir, <span class="math notranslate nohighlight">\(\nabla f(x_0, y_0, z_0)\)</span>. O segundo é o vector “velocidade” da traxectoria en <span class="math notranslate nohighlight">\(t_0\)</span>.</p>
<p>Nun espazo <span class="math notranslate nohighlight">\(\mathbb{R}^3\)</span>, dado un punto <span class="math notranslate nohighlight">\({\bf x}_0 = (x_0, y_0, z_0)\)</span> e un vector <span class="math notranslate nohighlight">\({\bf n}\)</span>. Podemos dar a ecuación do plano normal a <span class="math notranslate nohighlight">\({\bf n}\)</span>, que pasa por <span class="math notranslate nohighlight">\({\bf x}_0\)</span>, como aqueles puntos, <span class="math notranslate nohighlight">\({\bf x} = (x, y, z)\)</span> para os cales o vector, <span class="math notranslate nohighlight">\({\bf x} - {\bf x}_0\)</span>, <span class="math notranslate nohighlight">\((x - x_0, y - y_0, z - z_0)\)</span>, é ortogonal a <span class="math notranslate nohighlight">\({\bf n}\)</span>, é dicir:</p>
<div class="math notranslate nohighlight">
\[
 ({\bf x} - {\bf x}_0) \, {\bf n} = 0
 \]</div>
<p>Se observamos o caso anterior, a “velocidade” da traxectoria, <span class="math notranslate nohighlight">\({\bf r}'(t_0)\)</span>, debe estar contida entón no plano tanxente ao conxunto de nivel <span class="math notranslate nohighlight">\(f(x, y, z) = c\)</span> en <span class="math notranslate nohighlight">\((x_0, y_0, z_0)\)</span>, perpendicular ao vector <span class="math notranslate nohighlight">\(\nabla f(x_0, y_0, z_0)\)</span>.</p>
<p>Ese plano vén dado pola ecuación:</p>
<div class="math notranslate nohighlight">
\[
({\bf x} - {\bf x}_0) \, \nabla f({\bf x}_0) = 0
\]</div>
<div class="math notranslate nohighlight">
\[
f'_x(x_0, y_0, z_0) \, (x - x_0) \, + \, f'_y(x_0, y_0, z_0) \, (y - y_0) + \, f'_z(x_0, y_0, z_0) \, (z - z_0) \, = \, 0.
\]</div>
<p>Cómpre decatarse de que esta forma de dar o plano só funciona para funcións, <span class="math notranslate nohighlight">\(f(x, y, z)\)</span>, que teñen un gradiente nun punto, <span class="math notranslate nohighlight">\(\nabla f(x_0, y_0, z_0)\)</span>, distinto de cero.</p>
<p>A seguinte cela mostra o plano tanxente nun punto ao conxunto de nivel da función <span class="math notranslate nohighlight">\(f(x, y, z) = x^2 + y^2 + z^2\)</span> de valor <span class="math notranslate nohighlight">\(c=1\)</span>, que corresponde a a esfera de raio unitario.</p>
<p>Tamén se mostra o gradiente da función no punto da esfera dado por <span class="math notranslate nohighlight">\(\theta = \pi/4, \; \phi = 3\pi/2\)</span>, e dúas traxectorias dentro da esfera, unha vertical, meridiano, e outra horizontal, paralelo, que pasan por ese punto. Tamén se poden ver os vectores “velocidade” desas traxectorias, que están, por suposto, dentro do plano.</p>
<p><em>Explora</em> e cambia o punto da esfera.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theta0</span><span class="p">,</span> <span class="n">phi0</span> <span class="o">=</span> <span class="mi">1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">4.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span>
<span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">grad</span><span class="p">,</span> <span class="n">vphi</span><span class="p">,</span> <span class="n">vtheta</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">sphere_plane</span><span class="p">(</span><span class="n">theta0</span><span class="p">,</span> <span class="n">phi0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">);</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;gradiente   :&#39;</span><span class="p">,</span> <span class="n">grad</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;v-paralelo  :&#39;</span><span class="p">,</span> <span class="n">vphi</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;v-meridiano :&#39;</span><span class="p">,</span> <span class="n">vtheta</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gradiente   : (8.659560562354932e-17, -1.414213562373095, 1.4142135623730951)
v-paralelo  : (0.7071067811865475, 4.329780281177466e-17, 0.0)
v-meridiano : (4.329780281177467e-17, -0.7071067811865476, -0.7071067811865475)
</pre></div>
</div>
<img alt="../_images/b0319df9dc7f98ea5d031054abc81332abf06376b693ccffd75747fc07636cbb.png" src="../_images/b0319df9dc7f98ea5d031054abc81332abf06376b693ccffd75747fc07636cbb.png" />
</div>
</div>
<p><em>Exercicio</em> : Sexa a función <span class="math notranslate nohighlight">\(f(x, y, z) = x^2 + y^2 + z^2\)</span>, e o punto <span class="math notranslate nohighlight">\({\bf x}_0 = \left(0, -1/{\sqrt {2}}, 1/{\sqrt{2}} \right)\)</span>, calcula o plano tanxente do conxunto de nivel da función á que pertence o punto.</p>
<p>O valor da función no punto é <span class="math notranslate nohighlight">\(f ({\bf x_0}) = 1\)</span>, entón o punto pertence ao conxunto de nivel establecido co valor <span class="math notranslate nohighlight">\(c = 1\)</span>.</p>
<p>O conxunto de nivel <span class="math notranslate nohighlight">\(f(x, y, z) = 1\)</span> é a esfera de raio unitario: <span class="math notranslate nohighlight">\(x^2 + y^2 + z^2 = 1\)</span>.</p>
<p>O punto <span class="math notranslate nohighlight">\({\bf x}_0\)</span>, en coordenadas esféricas é <span class="math notranslate nohighlight">\(r = 1, \theta = \pi/4, \phi = 3 \pi/2\)</span>.</p>
<p>O gradiente da función é: <span class="math notranslate nohighlight">\(\nabla f (x, y, z) = (2 x, 2y, 2z)\)</span>.</p>
<p>E no punto <span class="math notranslate nohighlight">\({\bf x}_0\)</span> vale: <span class="math notranslate nohighlight">\(\nabla f ({\bf x}_0) = \left(0, -\sqrt{2}, \sqrt{2}\right)\)</span> .</p>
<p>O plano tanxente, nun punto <span class="math notranslate nohighlight">\({\bf x}_0\)</span> da esfera cumpre coa ecuación:</p>
<div class="math notranslate nohighlight">
\[
 2x_0 (x - x_0) + 2 y_0 (y - y_0) + 2 z_0 (z - z_0) = 0
 \]</div>
<p>E no punto <span class="math notranslate nohighlight">\({\bf x}_0\)</span> é:</p>
<div class="math notranslate nohighlight">
\[
-\sqrt{2} \left( y + \frac{1}{\sqrt{2}} \right) + \sqrt{2} \left( z - \frac{1}{\sqrt{2}} \right) = 0
\]</div>
<p>Polo tanto, o plano tanxente ten a ecuación:</p>
<div class="math notranslate nohighlight">
\[
 z = y + \sqrt{2}
 \]</div>
<p><strong>Aínda hai máis!</strong></p>
<p>As simetrías en Física son fundamentais. Foi a gran física <a class="reference external" href="https://gl.wikipedia.org/wiki/Emmy_Noether">Emmy Noether</a> quen formulou un teorema que afirma que detrás dunha simetría hai unha cantidade conservada en física. Por exemplo, se o problema ten simetría esférica, a cantidade conservada é o momento angular.</p>
<p>Emmy Noether sufriu por desgraza os males do seu tempo (e que aínda persisten no noso), o machismo dos seus compañeiros de universidade e o racismo nazi.</p>
<p><strong>Isto é todo por agora!</strong></p>
</section>
</section>
<section id="apendice">
<h2>Apéndice<a class="headerlink" href="#apendice" title="Permalink to this heading">#</a></h2>
<p><em>Proba</em> da regra da cadea</p>
<p>As dúas funcións son diferenciables:</p>
<div class="math notranslate nohighlight">
\[
{\bf g}({\bf x}+{\bf v}) -{\bf g}({\bf x})  = {\bf Dg}({\bf x})\,{\bf v} 
+ \| {\bf v} \| {\bf E}_g({\bf x,v}) 
\]</div>
<div class="math notranslate nohighlight">
\[
{\bf f}({\bf y}+{\bf u}) -{\bf f}({\bf y})  = {\bf Df}({\bf y})\, {\bf u} + \| {\bf u} \| {\bf E}_f({\bf y,u}) 
\]</div>
<p>Como <span class="math notranslate nohighlight">\({\bf u} = {\bf g}({\bf x}+{\bf v}) -{\bf g}({\bf x})\)</span>, temos:</p>
<div class="math notranslate nohighlight">
\[
{\bf f}({\bf y}+{\bf u}) -{\bf f}({\bf y})  = {\bf Df}({\bf y}) \left( {\bf Dg}({\bf x}) \, {\bf v} + \| {\bf v} \| {\bf E}_g({\bf x,v}) \right) 
+ \| {\bf u} \| {\bf E}_f({\bf y,u}) 
\]</div>
<div class="math notranslate nohighlight">
\[
=  {\bf Df}({\bf y}){\bf Dg}({\bf x}) \, {\bf v} + \| {\bf v} \| \left( {\bf Df}({\bf y}) \, {\bf E}_g({\bf x,v})  
+ \frac{\| {\bf u} \|}{\| {\bf v} \|} {\bf E}_f({\bf y,u}) \right) 
\]</div>
<p>Que podemos asociar a:</p>
<div class="math notranslate nohighlight">
\[
 {\bf h}({\bf x}+{\bf v}) -{\bf h}({\bf x})  =  {\bf Dh}({\bf x}) \, {\bf v} + \| {\bf v} \| {\bf E}_h ({\bf x,v}) 
 \]</div>
<p>Onde</p>
<div class="math notranslate nohighlight">
\[
{\bf Dh}({\bf x}) = {\bf Df}({\bf y}) \, {\bf Dg}({\bf x})
\]</div>
<div class="math notranslate nohighlight">
\[
{\bf E}_h({\bf x,v})  = {\bf Df}({\bf y}) \, {\bf E}_g({\bf x,v})  + \frac{\| {\bf u} \|}{\| {\bf v} \|} {\bf E}_f({\bf y,v}) 
\]</div>
<p>A derivada é o produto das derivadas.</p>
<p>Só fica comprobar que: <span class="math notranslate nohighlight">\(\lim_{{\bf v} \to {\bf 0}} {\bf E}_h({\bf x,v}) \to {\bf 0}\)</span>.</p>
<p>O primeiro termo é directo <span class="math notranslate nohighlight">\({\bf E}_g({\bf x,v}) \to {\bf 0}\)</span>.</p>
<p>No segundo podemos acotar, <span class="math notranslate nohighlight">\(\frac{\| u \|}{\| v \| } \leq M_g({\bf x}) + \| {\bf E}_g({\bf x,v}) \|\)</span>, onde
<span class="math notranslate nohighlight">\(M_g({\bf x}) = \sum_{k=1}^n \| \nabla g_k({\bf x}) \|\)</span>.</p>
<p>xa que <span class="math notranslate nohighlight">\({\bf u} = {\bf g(x+v)} - {\bf g(x)} = {\bf Dg}({\bf x}) {\bf v} + \| {\bf v} \| {\bf E}_g({\bf x,v})\)</span> e polo tanto <span class="math notranslate nohighlight">\(\| {\bf u} \| \le \left( \sum_{i=1}^n \| \nabla g_k \| + \| {\bf E_g}(y, v) \| \right) \| {\bf v} \|\)</span>.</p>
<p>Cando  <span class="math notranslate nohighlight">\({\bf v} \to {\bf 0}\)</span> tamén <span class="math notranslate nohighlight">\({\bf u} \to {\bf 0}\)</span> e <span class="math notranslate nohighlight">\({\bf E}_f({\bf y, u}) \to {\bf 0}\)</span>.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="tderivadas_gradiante_xacobiana.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Gradiente, matriz xacobiana, funcións diferenciables</p>
      </div>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#obxectivos">Obxectivos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cambio-de-variables">Cambio de variables</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cambios-de-coordenadas">Cambios de coordenadas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matriz-de-cambio-de-coordenadas-xacobianas">Matriz de cambio de coordenadas xacobianas</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#a-regra-da-cadea">A regra da cadea</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#teorema-da-regra-da-cadea">Teorema da regra da cadea</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apendice">Apéndice</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By José Ángel Hernando Morata, X. Cid Vidal
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright USC - J.A. Hernando, X. Cid Vidal - 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>