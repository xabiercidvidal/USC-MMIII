

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Mínimos e máximos de funcións escalares &#8212; Métodos Matemáticos III - USC</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/tderivadas_min_max';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Cambio de coordenadas e regra da cadea" href="tderivadas_coordenadas_cadea.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introdución
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Notas prácticas</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../notas_practicas.html">Como acceder ás notas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../run_cloud.html">Executar os apuntes na nube</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Derivadas en varias dimensións</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="tderivadas_introducion.html">Cuestións iniciais</a></li>
<li class="toctree-l1"><a class="reference internal" href="tderivadas_funcion_escalar_vectorial.html">Funcións escalares, gráficos, conxuntos de nivel e funcións vectoriais.</a></li>
<li class="toctree-l1"><a class="reference internal" href="tderivadas_limites_continuidade.html">Límite e continuidade das funcións escalares e vectoriais</a></li>
<li class="toctree-l1"><a class="reference internal" href="tderivadas_parametrizacion_linhas_superficies.html">Parametrización de curvas e superficies</a></li>
<li class="toctree-l1"><a class="reference internal" href="tderivadas_direccional_diferencial.html">Derivadas direccionais e funcións derivables</a></li>
<li class="toctree-l1"><a class="reference internal" href="tderivadas_gradiante_xacobiana.html">Gradiente, matriz xacobiana, funcións diferenciables</a></li>
<li class="toctree-l1"><a class="reference internal" href="tderivadas_coordenadas_cadea.html">Cambio de coordenadas e regra da cadea</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Mínimos e máximos de funcións escalares</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/xabiercidvidal/USC-MMIII/main?urlpath=tree/notebooks/tderivadas_min_max.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/xabiercidvidal/USC-MMIII/blob/main/notebooks/tderivadas_min_max.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/xabiercidvidal/USC-MMIII" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/xabiercidvidal/USC-MMIII/issues/new?title=Issue%20on%20page%20%2Fnotebooks/tderivadas_min_max.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/tderivadas_min_max.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Mínimos e máximos de funcións escalares</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#obxectivos">Obxectivos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#desenvolvemento-de-taylor-de-bf-2-rm-bf-a-orde-de-funcions-escalares">Desenvolvemento de Taylor de <span class="math notranslate nohighlight">\(\bf 2^{\rm \bf a}\)</span> orde de funcións escalares.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#revision-dos-conceptos-de-extremos-minimos-e-maximos">Revisión dos conceptos de extremos, mínimos e máximos.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#igualdade-de-derivadas-segundas-cruzadas">Igualdade de derivadas segundas cruzadas</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#expansion-de-taylor-de-segunda-orde-de-funcions-escalares">Expansión de Taylor de segunda orde de funcións escalares</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimos-e-maximos-das-funcions-escalares">Mínimos e máximos das funcións escalares</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clasificacion-de-puntos-extremos">Clasificación de puntos extremos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minimos-e-maximos-para-funcions-escalares-de-varias-dimensions">Mínimos e máximos para funcións escalares de varias dimensións</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimos-e-maximos-condicionais">Mínimos e máximos condicionais</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiplicadores-de-lagrange">Multiplicadores de Lagrange</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ainda-hai-mais">Aínda hai máis!</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#joseph-louis-lagrange">Joseph Louis Lagrange</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#principio-de-minima-accion">Principio de mínima acción</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#o-metodo-dos-minimos-cadrados">O método dos mínimos cadrados</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#as-redes-neuronais">As redes neuronais</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apendices">Apéndices</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="minimos-e-maximos-de-funcions-escalares">
<h1>Mínimos e máximos de funcións escalares<a class="headerlink" href="#minimos-e-maximos-de-funcions-escalares" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39; Última execución  &#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">asctime</span><span class="p">()</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Última execución   Tue Feb 27 23:14:15 2024
</pre></div>
</div>
</div>
</div>
<section id="obxectivos">
<h2>Obxectivos<a class="headerlink" href="#obxectivos" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Lembrar o concepto de mínimo e máximo dunha función real e como se calcula.</p></li>
<li><p>Introducir a expansión de Taylor de segunda orde das funcións escalares e a matriz de Hesse.</p></li>
<li><p>Comentar a condición suficiente.</p></li>
<li><p>Relación entre os mínimos e os máximos e os autovalores da matriz de Hesse.</p></li>
<li><p>Exemplos de cálculos de mínimos e máximos.</p></li>
<li><p>Introducir o concepto de mínimos condicionais.</p></li>
<li><p>Introducir o método dos multiplicadores de Lagrange.</p></li>
</ul>
<p><em>Nota</em></p>
<p>Para que este notebook funcione en colab, precisamos <a href = "https://www.dropbox.com/scl/fi/wwz2w43kqj0s38gm87roj/graph_utils.py?rlkey=rppkwu9tmbnnsojezzj69p1r0&dl=1"> graph_utils.py </a>. Podes descargalo premendo na ligazón, e subilo a colab:</p>
<a class="reference internal image-reference" href="https://www.dropbox.com/scl/fi/b35vcated0f9lwrw4jy01/colab_upload.jpg?rlkey=l1ag15r0ovkg2dsefze117k1y&amp;raw=1"><img alt="https://www.dropbox.com/scl/fi/b35vcated0f9lwrw4jy01/colab_upload.jpg?rlkey=l1ag15r0ovkg2dsefze117k1y&amp;raw=1" class="align-center" src="https://www.dropbox.com/scl/fi/b35vcated0f9lwrw4jy01/colab_upload.jpg?rlkey=l1ag15r0ovkg2dsefze117k1y&amp;raw=1" style="width: 200px;" /></a>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># general imports</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="o">%</span><span class="k">reload_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2

<span class="c1"># numpy and matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">graph_utils</span> <span class="k">as</span> <span class="nn">gf</span>

<span class="n">figsize</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span> <span class="mf">3.8</span>
<span class="n">cmap</span>    <span class="o">=</span> <span class="s1">&#39;hot&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="desenvolvemento-de-taylor-de-bf-2-rm-bf-a-orde-de-funcions-escalares">
<h2>Desenvolvemento de Taylor de <span class="math notranslate nohighlight">\(\bf 2^{\rm \bf a}\)</span> orde de funcións escalares.<a class="headerlink" href="#desenvolvemento-de-taylor-de-bf-2-rm-bf-a-orde-de-funcions-escalares" title="Permalink to this heading">#</a></h2>
<section id="revision-dos-conceptos-de-extremos-minimos-e-maximos">
<h3>Revisión dos conceptos de extremos, mínimos e máximos.<a class="headerlink" href="#revision-dos-conceptos-de-extremos-minimos-e-maximos" title="Permalink to this heading">#</a></h3>
<p>Para as funcións reais, <span class="math notranslate nohighlight">\(f(x)\)</span>, tiñamos definido como mínimo local, ese valor <span class="math notranslate nohighlight">\(x_0\)</span> do dominio tal que nos valores dun intervalo ao seu redor, de ancho <span class="math notranslate nohighlight">\(h\)</span>, a función é maior ou igual a en <span class="math notranslate nohighlight">\(x_0\)</span>. De xeito semellante definimos o máximo local.</p>
<p>Chamamos mínimo local:</p>
<div class="math notranslate nohighlight">
\[
x \in [x_0 - h, x_0 + h] \Rightarrow f(x) \ge f(x_0)
\]</div>
<p>Chamamos máximo local:</p>
<div class="math notranslate nohighlight">
\[
x \in [x_0 - h, x_0 + h] \Rightarrow f(x) \le f(x_0)
\]</div>
<p><span class="math notranslate nohighlight">\(x_0\)</span> é un mínimo global se todo o valor da función en todos os puntos do dominio é maior que en <span class="math notranslate nohighlight">\(x_0\)</span>, e do mesmo xeito para o máximo.</p>
<p><em>Exemplo</em> : A seguinte función real, <span class="math notranslate nohighlight">\(f(x) = x^2+2x-1\)</span>, presenta un mínimo local en <span class="math notranslate nohighlight">\(x_0 = -1\)</span>.</p>
<p>Lembras como calculabamos os mínimos ou máximos? Ambos cumprían a condición de que a súa pendente fose cero e o signo da segunda derivada dicíanos, se era positivo, era un mínimo, e se era negativo, era un máximo.</p>
<p>Condición de extremos: <span class="math notranslate nohighlight">\(f'(x_0) = 0\)</span></p>
<p>Condición de máximo: <span class="math notranslate nohighlight">\(f''(x_0) &lt; 0\)</span> e de mínimo <span class="math notranslate nohighlight">\(f''(x_0) &gt;0\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">gf</span><span class="o">.</span><span class="n">fun1d</span><span class="p">(</span><span class="n">fun</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/4c3c15ad98ace6be397f227c383876e0a9cce8386c30df0c44f39616fbd9c886.png" src="../_images/4c3c15ad98ace6be397f227c383876e0a9cce8386c30df0c44f39616fbd9c886.png" />
</div>
</div>
<p>Neste caso, con <span class="math notranslate nohighlight">\(f(x) = x^2 + 2x - 1\)</span>, a condición de extremo: <span class="math notranslate nohighlight">\(f'(x_0) = 2 x_0 + 2 = 0\)</span>, o que resulta en <span class="math notranslate nohighlight">\(x_0 = -1\)</span>.</p>
<p>Este é un mínimo, xa que <span class="math notranslate nohighlight">\(f''(x_0) = 2\)</span></p>
<p>Se lembras, podiamos obter os mínimos e os máximos grazas a que esta función é diferenciable, admite expansión de Taylor de segunda orde.</p>
<p>A expansión de Taylor de segunda orde dunha función real, <span class="math notranslate nohighlight">\(f(x)\)</span>, é:</p>
<div class="math notranslate nohighlight">
\[
f(x_0 + h) \simeq f(x_0) + f'(x_0) h + \frac{1}{2} f''(x_0) h^2
\]</div>
<p>onde <span class="math notranslate nohighlight">\(h\)</span> é un tamaño “pequeno”.</p>
<p>Lembra tamén que a condición suficiente para que unha función real teña unha expansión de Taylor de segunda orde nun valor <span class="math notranslate nohighlight">\(x_0\)</span> é que a súa segunda derivada nun entorno dese valor sexa continua.</p>
<p>Interpretando <span class="math notranslate nohighlight">\(f'(x_0)\)</span> como a pendente, vemos que para que a función non cambie o valor ao redor de <span class="math notranslate nohighlight">\(x_0\)</span>, a súa pendente ten que ser nula.</p>
<p>E entón, o segundo sumando, <span class="math notranslate nohighlight">\(\frac{1}{2} f''(x_0) h^2\)</span>, é positivo ou negativo dependendo do signo da segunda derivada, <span class="math notranslate nohighlight">\(f''(x_0)\)</span>. De aí a condición de mínimo ou máximo.</p>
</section>
<section id="igualdade-de-derivadas-segundas-cruzadas">
<h3>Igualdade de derivadas segundas cruzadas<a class="headerlink" href="#igualdade-de-derivadas-segundas-cruzadas" title="Permalink to this heading">#</a></h3>
<p>Antes de abordar a expansión de Taylor das funcións escalares de segunda orde, vexamos este importante teorema (<strong>teorema de Schwarz</strong>):</p>
<p><em>Teorema</em> : Sexa <span class="math notranslate nohighlight">\(f({\bf x})\)</span> unha función escalar de <span class="math notranslate nohighlight">\(\mathbb{R}^n \to \mathbb{R}\)</span>, se as segundas derivadas son continuas nunha bola centrada nun punto, <span class="math notranslate nohighlight">\( { \bf x}_0\)</span>, é certo que as derivadas cruzadas son iguais:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial^2 f({\bf x}_0)}{\partial x_i \partial x_j} = \frac{\partial^2 f({\bf x}_0)}{\partial x_j \partial x_i}
\]</div>
<p>con <span class="math notranslate nohighlight">\(i \ne j, \; i = 1, \dots, n; \, j = 1, \dots, n\)</span>.</p>
<a class="reference internal image-reference" href="https://www.dropbox.com/scl/fi/qcjrlo6eipu4ijp12atm0/GG2tezVWcAAfQRR.png?rlkey=1ta447kf9wsbsj37ivojmoo54&amp;raw=1"><img alt="https://www.dropbox.com/scl/fi/qcjrlo6eipu4ijp12atm0/GG2tezVWcAAfQRR.png?rlkey=1ta447kf9wsbsj37ivojmoo54&amp;raw=1" class="align-center" src="https://www.dropbox.com/scl/fi/qcjrlo6eipu4ijp12atm0/GG2tezVWcAAfQRR.png?rlkey=1ta447kf9wsbsj37ivojmoo54&amp;raw=1" style="width: 400px;" /></a>
</section>
</section>
<section id="expansion-de-taylor-de-segunda-orde-de-funcions-escalares">
<h2>Expansión de Taylor de segunda orde de funcións escalares<a class="headerlink" href="#expansion-de-taylor-de-segunda-orde-de-funcions-escalares" title="Permalink to this heading">#</a></h2>
<p>Sexa unha función escalar, <span class="math notranslate nohighlight">\(f({\bf x})\)</span>, de <span class="math notranslate nohighlight">\(\mathbb{R}^n \to \mathbb{R}\)</span>, con derivadas segundas continuas nun punto interior, <span class="math notranslate nohighlight">\({\bf x} _0 \)</span>, do dominio, a función pódese aproximar nun punto “preto”, <span class="math notranslate nohighlight">\({\bf x}\)</span>, separado de <span class="math notranslate nohighlight">\({\bf x}_0\)</span> por un vector “pequeno” <span class="math notranslate nohighlight">\({\bf v}\)</span> , pola súa <strong>expansión de Taylor de segunda orde</strong> :</p>
<div class="math notranslate nohighlight">
\[
f({\bf x}_0 + {\bf v}) \simeq f({\bf x}_0) + \sum_{i=1}^n \frac{\partial f({\bf x}_0)}{\partial x_i} v_i + \frac{1}{2}\sum_{i= 1}^n  \sum_{j=1}^n \frac{\partial^2 f({\bf x}_0)}{ \partial x_i \partial x_j} v_i v_j
\]</div>
<p>Que podemos reescribir en forma matricial:</p>
<div class="math notranslate nohighlight">
\[
f({\bf x}_0 + {\bf v}) \simeq f({\bf x}_0) + \nabla f({\bf x}_0) \, {\bf v} + \frac{1}{2} {\bf v}^T \, {\bf H}({\bf x}_0) \, {\bf v}
\]</div>
<p>onde <span class="math notranslate nohighlight">\({\bf H}({\bf x}_0)\)</span> é a <strong>matriz de Hesse</strong> valorada en <span class="math notranslate nohighlight">\({\bf x}_0\)</span>, para a cal as compoñentes son as segundas derivadas,</p>
<div class="math notranslate nohighlight">
\[
{\bf H}_{ij}({\bf x}_0) = \frac{\partial^2 f({\bf x}_0)}{ \partial x_i \partial x_j}
\]</div>
<p>e onde <span class="math notranslate nohighlight">\({\bf v}\)</span>, é o vector en forma de columna, e <span class="math notranslate nohighlight">\({\bf v}^T\)</span> en forma de fila.</p>
<p><em>Pregunta</em> : é a Hessiana unha matriz simétrica?</p>
<p><em>Pregunta</em> : está fóra do alcance deste curso, pero podes tentalo, como cres que sería a expansión de Taylor de segunda orde dunha función vectorial?</p>
<p><em>Fíxate</em> : hai polo menos unha función vectorial para a que coñeces a súa expansión de Taylor de 2ª orde. O da traxectoria dun móbil no tempo!</p>
<div class="math notranslate nohighlight">
\[
{\bf r}(t_0 + \Delta t) \simeq {\bf r}(t_0) + {\bf r}'(t_0) \Delta t + \frac{1}{2} {\bf r}''(t_0) (\Delta t)^2
\]</div>
<p><strong>Exemplo</strong> : Calcula a expansión de Taylor da función escalar, <span class="math notranslate nohighlight">\(f(x, y) = 2x^2 + 4 y^2\)</span>, no punto <span class="math notranslate nohighlight">\((0, 0)\)</span>.</p>
<p>Os diferentes sumandos da expansión de Taylor son:</p>
<div class="math notranslate nohighlight">
\[
 f({\bf x}_0) = 0
 \]</div>
<p>O gradiente é</p>
<div class="math notranslate nohighlight">
\[
 \nabla f ({\bf x}) = (4 x , 8 y)
 \]</div>
<p>Valorado na orixe é:</p>
<div class="math notranslate nohighlight">
\[
 \nabla f ({\bf x}_0) = (0, 0)
 \]</div>
<p>A matriz hessiana é:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
{\bf H}({\bf x}) = \left( \begin{array}{cc} 4 &amp; 0 \\ 0 &amp; 8\end{array} \right)
\end{split}\]</div>
<p>que é independente do punto, <span class="math notranslate nohighlight">\({\bf x}\)</span>.</p>
<p>Entón a expansión de Taylor con respecto ao punto <span class="math notranslate nohighlight">\({\bf x}_0\)</span> é:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
f({\bf x}_0 + {\bf v}) = \frac{1}{2} (v_x, v_y) \, \left( \begin{array}{cc} 4 &amp; 0 \\ 0 &amp; 8\end{array} \right) \, \left( \begin{array}{c} v_x \\ v_y \end{array} \right) =  2 v^2_x + 4 v^2_y 
\end{split}\]</div>
<p>Observa a gráfica da función e os seus conxuntos de nivel.</p>
<p><em>Pregunta</em> : Podes determinar se hai un mínimo ou un máximo local e onde?</p>
<p>É obvio, non?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="p">:</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">y</span>
<span class="n">gf</span><span class="o">.</span><span class="n">graph</span><span class="p">(</span><span class="n">fun</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f2a8a255e865ac903a80f01ff6666c24d203c57461cfebe5a57ad0c5604d8ba9.png" src="../_images/f2a8a255e865ac903a80f01ff6666c24d203c57461cfebe5a57ad0c5604d8ba9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gf</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">contours</span> <span class="o">=</span> <span class="mi">40</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/233212d0d6b33738fcd9d3521e4a210884e2179169dce735c38ba20821e8235f.png" src="../_images/233212d0d6b33738fcd9d3521e4a210884e2179169dce735c38ba20821e8235f.png" />
</div>
</div>
</section>
<section id="minimos-e-maximos-das-funcions-escalares">
<h2>Mínimos e máximos das funcións escalares<a class="headerlink" href="#minimos-e-maximos-das-funcions-escalares" title="Permalink to this heading">#</a></h2>
<p>Como nunha dimensión, chamaremos un punto <strong>extremo</strong> ou <strong>crítico</strong> , <span class="math notranslate nohighlight">\({\bf x}_0\)</span>, dunha función escalar diferenciable, <span class="math notranslate nohighlight">\(f({\bf x})\)</span>, de <span class="math notranslate nohighlight">\(\mathbb{R}^n \to \mathbb{R}\)</span>, a aqueles puntos do dominio para os cales gradiente é cero, <span class="math notranslate nohighlight">\(\nabla f ({\bf x}_0) = {\bf 0}\)</span>.</p>
<p>No exemplo anterior, a función escalar <span class="math notranslate nohighlight">\(f(x, y) = 2x^2 + 4y^2\)</span> ten un extremo en <span class="math notranslate nohighlight">\((0, 0)\)</span>.</p>
<p>Observa a gráfica e os conxuntos de nivel da seguinte función, <span class="math notranslate nohighlight">\(f(x, y) = 2x^2 - 4y^2\)</span>. Podes verificar que o punto <span class="math notranslate nohighlight">\((0, 0)\)</span> é un extremo, ten un gradiente cero (o gradiente é <span class="math notranslate nohighlight">\(\nabla f(x, y) = (4x, -8 y)\)</span> ), pero non o é nin máximo nin mínimo, é un <strong>punto de sela</strong> . Definimos como tal, o punto extremo dende o cal a función ascende nunha dirección e descende noutra.</p>
<p><em>Explora</em> e modifica o vector <span class="math notranslate nohighlight">\({\bf v}\)</span> superposto aos conxuntos de nivel e observa como dependendo da dirección de <span class="math notranslate nohighlight">\({\bf v}\)</span> a función finalmente ascende ou descende.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">y</span> 
<span class="n">gf</span><span class="o">.</span><span class="n">graph</span><span class="p">(</span><span class="n">fun</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/6ec77d1ecfec14d3f263db2dfd1c4dcf65fee91de6c945a0d10634f776f1da44.png" src="../_images/6ec77d1ecfec14d3f263db2dfd1c4dcf65fee91de6c945a0d10634f776f1da44.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span>  <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span>
<span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span>  <span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span>
<span class="n">gf</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">contours</span> <span class="o">=</span> <span class="mi">40</span><span class="p">);</span>
<span class="n">gf</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/eb4bb90ca78e0da7135398cc7e66c71a819e3ac8f112d0d2784c15f737ab1bfd.png" src="../_images/eb4bb90ca78e0da7135398cc7e66c71a819e3ac8f112d0d2784c15f737ab1bfd.png" />
</div>
</div>
<p><em>Exercicio</em> : Da a expansión de Taylor de segunda orde da función <span class="math notranslate nohighlight">\(f(x, y) = 2 x^2 - 4 y^2\)</span> no punto de sela <span class="math notranslate nohighlight">\((0, 0)\)</span>.</p>
<p>A función en <span class="math notranslate nohighlight">\({\bf x}_0\)</span> é:</p>
<div class="math notranslate nohighlight">
\[
f({\bf x}_0) = 0
\]</div>
<p>O gradiente é nulo:</p>
<div class="math notranslate nohighlight">
\[
\nabla f(x, y) = (4 x, -8y) \Rightarrow \nabla f({\bf x}_0) = (0, 0)
\]</div>
<p>A matriz hessiana é:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
{\bf H}({\bf x}) = \left( \begin{array}{cc} 4 &amp; 0 \\ 0 &amp; -8\end{array} \right)
\end{split}\]</div>
<p>que é independente do punto, <span class="math notranslate nohighlight">\({\bf x}\)</span>.</p>
<p>Entón a expansión de Taylor con respecto ao punto <span class="math notranslate nohighlight">\({\bf x}_0\)</span> é:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
f({\bf x}_0 + {\bf v}) =  \frac{1}{2} (v_x, v_y) \, \left( \begin{array}{cc} 4 &amp; 0 \\ 0 &amp; - 8\end{array} \right) \, \left( \begin{array}{c} v_x \\ v_y \end{array} \right) =  2 v^2_x - 4 v^2_y 
\end{split}\]</div>
<p>Onde vemos que se avanzamos <em>só</em> na dirección <span class="math notranslate nohighlight">\(x\)</span> a función ascende, mentres que se avanzamos <em>só</em> na dirección <span class="math notranslate nohighlight">\(y\)</span> descende. É polo tanto un punto de sela.</p>
<section id="clasificacion-de-puntos-extremos">
<h3>Clasificación de puntos extremos<a class="headerlink" href="#clasificacion-de-puntos-extremos" title="Permalink to this heading">#</a></h3>
<p>Os puntos extremos dunha función escalar serán máximos, mínimos ou puntos de sela, dependendo do valor do termo da matriz de Hesse da súa expansión de Taylor:</p>
<div class="math notranslate nohighlight">
\[
 \frac{1}{2} {\bf v}^T \, {\bf H}({\bf x}_0) \, {\bf v}
 \]</div>
<p>Se para cada vector <span class="math notranslate nohighlight">\({\bf v}\)</span> o termo é positivo, entón é un mínimo, a función sempre ascende.</p>
<p>Se é negativo, é un máximo, a función sempre descende. E se, segundo o vector, é positivo ou negativo, é un punto de sela, a función ascende nunha dirección e descende noutra.</p>
<p>Considera o caso dunha función escalar <span class="math notranslate nohighlight">\(f(x, y)\)</span> de <span class="math notranslate nohighlight">\(\mathbb{R}^2 \to \mathbb{R}\)</span>, na que a matriz de Hesse é diagonal e os elementos da diagonal son <span class="math notranslate nohighlight">\( \lambda_1, \lambda_2\)</span> nun punto extremo <span class="math notranslate nohighlight">\({\bf x_0}\)</span>.</p>
<p>O termo do Hessiano no desenvolvemento de Taylor sería:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\frac{1}{2} (v_x, v_y) \, \left( \begin{array}{cc} \lambda_1 &amp; 0 \\ 0 &amp; \lambda_2\end{array} \right) \, \left( \begin{array}{c} v_x \\ v_y \end{array} \right) = \frac{1}{2}\left( \lambda_1 v^2_x + \lambda_2 v^2_y \right)
\end{split}\]</div>
<p>Podemos ver que se os dous valores son positivos, <span class="math notranslate nohighlight">\(\lambda_1 &gt; 0, \lambda_2 &gt;0\)</span>, o punto será un mínimo, para calquera vector <span class="math notranslate nohighlight">\((v_x, v_y)\)</span> a función ascende.</p>
<p>Se ambos son negativos, <span class="math notranslate nohighlight">\(\lambda_1 &lt; 0, \lambda_2 &lt; 0\)</span>, é un máximo, a función sempre descende.</p>
<p>Se un é negativo e o outro positivo, dependerá do vector <span class="math notranslate nohighlight">\((v_x, v_y)\)</span>, en certas direccións a función aumenta e noutras diminúe, entón será un punto de sela.</p>
<p><em>Exercicio</em> : Calcula a matriz de Hesse para o punto extremo <span class="math notranslate nohighlight">\((0, 0)\)</span> da función, <span class="math notranslate nohighlight">\(f(x, y) = 3 x^2 + 3y^2 - 2xy\)</span>.</p>
<p><em>Observa</em> a gráfica desta función e os seus conxuntos de nivel.</p>
<p>O gradiente é:</p>
<div class="math notranslate nohighlight">
\[
\nabla f(x, y) = (6 x - 2y, 6y - 2x)
\]</div>
<p>E a matriz Hessiana:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
{\bf H}(x, y) = \left( \begin{array}{cc} 6 &amp; -2 \\ -2 &amp; 6\end{array}\right)
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">y</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">y</span>
<span class="n">gf</span><span class="o">.</span><span class="n">graph</span><span class="p">(</span><span class="n">fun</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/05b4ab67ed7171a92f7ae3792bf3c5aa6bf61a41aefaf1e1c06f26c67e99c15b.png" src="../_images/05b4ab67ed7171a92f7ae3792bf3c5aa6bf61a41aefaf1e1c06f26c67e99c15b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gf</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">contours</span><span class="o">=</span><span class="mi">40</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/b0d45456499af8f1c4a3780612255fba09139d7170cd300db071244153e9783f.png" src="../_images/b0d45456499af8f1c4a3780612255fba09139d7170cd300db071244153e9783f.png" />
</div>
</div>
<p>¿E se a Hesiana no punto extremo, <span class="math notranslate nohighlight">\({\bf x}_0\)</span>, non é diagonal?</p>
<p>Sabemos que a matriz de Hesse, xa que as segundas derivadas son continuas, é simétrica, e tamén sabemos que as matrices simétricas son diagonalizables.</p>
<p>Polo tanto, existe unha base ortonormal, <span class="math notranslate nohighlight">\(\{{\bf e}'_1, {\bf e}'_2 \}\)</span>, na que a matriz de Hesse é diagonal, <span class="math notranslate nohighlight">\({\bf H}'({\bf x}_0)\)</span> con auto-valores <span class="math notranslate nohighlight">\(\lambda'_1, \lambda'_2\)</span>. A relación entre ambos vén dada pola matriz de cambio de bases ortonormal <span class="math notranslate nohighlight">\({\bf U}\)</span>.</p>
<div class="math notranslate nohighlight">
\[
{\bf H}({\bf x}_0) = {\bf U} \, {\bf H}' ({\bf x}_0) \, {\bf U}^T
\]</div>
<p>donde:</p>
<div class="math notranslate nohighlight">
\[
{\bf U} { \bf U}^T = {\bf U}^T { \bf U}  = {\bf I}
\]</div>
<p>Podemos expresar o vector <span class="math notranslate nohighlight">\({\bf v}\)</span> na base dos autovectores (denotámolo como <span class="math notranslate nohighlight">\({\bf v}'\)</span>), cambiando:</p>
<div class="math notranslate nohighlight">
\[
{\bf v} = {\bf U} \, {\bf v}'
\]</div>
<p>Podemos entón reescribir o termo Hessiano da expansión de Taylor en base aos autovectores:</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{2}{\bf v}^T \, {\bf H}({\bf x}_0) \, {\bf v} = \frac{1}{2}{\bf v}'^T {\bf U}^T \, {\bf U} {\bf H}'({\bf x_0}){\bf U}^T \, {\bf U} {\bf v}'= \frac{1}{2} {\bf v}'^T \, {\bf H}'({\bf x_0}) \,{\bf v}'
\]</div>
<p>É dicir, o termo hessiano da expansión de Taylor non depende da base na que o calculemos.</p>
<p>Se expresamos o vector <span class="math notranslate nohighlight">\((v_x, v_y)\)</span> na base dos autovectores, é dicir, <span class="math notranslate nohighlight">\((v'_x, v'_y)\)</span>, temos</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\frac{1}{2} {\bf v'}^T \, {\bf H}'({\bf x}_0) \, {\bf v}' =   \frac{1}{2} (v'_x, v'_y) \, \left( \begin{array}{cc} \lambda'_1 &amp; 0 \\ 0 &amp; \lambda'_2\end{array} \right) \, \left( \begin{array}{c} v'_x \\ v'_y \end{array} \right) = 
\frac{1}{2} \left( \lambda'_1 v'^2_x + \lambda'_2 v'^2_y \right)
\end{split}\]</div>
<p>E polo tanto, se os dous autovalores da Hessiana son positivos, <span class="math notranslate nohighlight">\(\lambda'_1 &gt; 0, \lambda'_2 &gt;0\)</span>, o punto extremo <span class="math notranslate nohighlight">\({\bf x}_0\)</span> é mínimo; se ambos son negativos <span class="math notranslate nohighlight">\(\lambda'_2 &gt;0\)</span>, o punto extremo <span class="math notranslate nohighlight">\({\bf x}_0\)</span> é mínimo; se os dous son negativos , é un máximo, e se un é positivo e o outro negativo, é un punto de sela.</p>
<p>No exemplo anterior, a Hessiana era:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
{\bf H}(x, y) = \left( \begin{array}{cc} 6 &amp; -2 \\ -2 &amp; 6\end{array}\right)
\end{split}\]</div>
<p>Calculamos os seus autovalores:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left| \begin{array}{cc} (6-\lambda) &amp; -2 \\ -2 &amp; (6-\lambda) \end{array}\right| = (6-\lambda)^2 -4 = 0
\end{split}\]</div>
<p>Isto é:</p>
<div class="math notranslate nohighlight">
\[
(6-\lambda) = \pm 2 \; \Rightarrow \, \lambda = 6 \pm 2 \; \Rightarrow \, \lambda'_1 = 4, \; \lambda'_2 = 8
\]</div>
<p>O punto extremo é mínimo porque ambos autovalores son positivos.</p>
<p>Calculemos os seus autovectores <span class="math notranslate nohighlight">\({\bf e}'_1 = (u_x, u_y), \; {\bf e}'_2 = (v_x, v_y)\)</span>, que lembramos que deben ser ortonormais:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
 \left( \begin{array}{cc} 6 &amp; -2 \\ -2 &amp; 6\end{array}\right) \, \left( \begin{array}{c} u_x \\ u_y \end{array}\right) = 4 \left( \begin{array}{c} u_x \\ u_y \end{array} \right)
\end{split}\]</div>
<p>Isto é:</p>
<div class="math notranslate nohighlight">
\[
6 u_x - 2 u_y =  4 u_x \; \Rightarrow 2u_x =  2u_y \; \Rightarrow u_x = u_y \
\]</div>
<p>Como o vector ten norma unitaria:</p>
<div class="math notranslate nohighlight">
\[
{\bf e}'_1 = \left( \frac{1}{\sqrt{2}}, \frac{1}{\sqrt{2}} \right)
\]</div>
<p>Mientres que para o segundo autovector:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
 \left( \begin{array}{cc} 6 &amp; -2 \\ -2 &amp; 6\end{array}\right) \, \left( \begin{array}{c} v_x \\ v_y \end{array}\right) = 8 \left( \begin{array}{c} v_x \\ v_y \end{array} \right)
\end{split}\]</div>
<p>Isto é:</p>
<div class="math notranslate nohighlight">
\[
6 v_x - 2 v_y =  8 v_x \; \Rightarrow  -2 v_x =  2 v_y \; \Rightarrow \, v_x = - v_y
\]</div>
<p>Como teñen que ser ortonormais:</p>
<div class="math notranslate nohighlight">
\[
{\bf e}'_2 = \left( -\frac{1}{\sqrt{2}}, \frac{1}{\sqrt{2}} \right)
\]</div>
<p>Na seguinte cela debuxamos os conxuntos de nivel da función e no punto extremo debuxamos os autovectores.</p>
<p><em>Pregunta</em> : Podes dar a relación entre os autovectores, os autovalores e os conxuntos de nivel da expansión de Taylor arredor dun extremo?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span>              <span class="mf">0.</span><span class="p">,</span>            <span class="mf">0.</span>
<span class="n">ux</span><span class="p">,</span> <span class="n">uy</span> <span class="o">=</span>  <span class="mf">1.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span> <span class="mf">1.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">)</span>
<span class="n">vx</span><span class="p">,</span> <span class="n">vy</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">),</span> <span class="mf">1.</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">)</span>
<span class="n">gf</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">contours</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">gf</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">ux</span><span class="p">,</span> <span class="n">uy</span><span class="p">)</span>
<span class="n">gf</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">vx</span><span class="p">,</span> <span class="n">vy</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ae87edf33561fc2cc50f8e96b8100962055914edd388294e8b0ce11c56144019.png" src="../_images/ae87edf33561fc2cc50f8e96b8100962055914edd388294e8b0ce11c56144019.png" />
</div>
</div>
<p>A expansión de Taylor de segunda orde arredor dun punto extremo <em>sempre</em> ten eixes de simetría, que veñen dados polos autovectores.</p>
<p>A ecuación dos conxuntos de nivel de valor <span class="math notranslate nohighlight">\(c\)</span> na expansión de Taylor de segunda orde nun punto extremo, <span class="math notranslate nohighlight">\((x'_0, y'_0)\)</span>, na base dos autovectores, vén dada por:</p>
<div class="math notranslate nohighlight">
\[
f(x'_0 + v'_x, \, y'_0 + v'_y) \simeq f(x'_0, y'_0) + \frac{1}{2}\left( \lambda'_1 v'^2_x + \lambda'_2 v'^2_y \right) = c
\]</div>
<p>Os conxuntos de nivel son <em>elipses</em> se é un mínimo ou máximo, ou <em>hipérbolas</em> se é un punto de sela, respecto dos seus eixes de simetría.</p>
<p>Os autovalores cuantifican a curvatura en cada un dos eixes de simetría. A curvatura é máis pronunciada canto maior sexa o autovalor.</p>
<p>Ou tamén podemos asocialos cos eixes das elipses dos conxuntos de nivel. O eixe da elipse é maior para os autovalores máis pequenos.</p>
</section>
<section id="minimos-e-maximos-para-funcions-escalares-de-varias-dimensions">
<h3>Mínimos e máximos para funcións escalares de varias dimensións<a class="headerlink" href="#minimos-e-maximos-para-funcions-escalares-de-varias-dimensions" title="Permalink to this heading">#</a></h3>
<p>Sexa a función escalar, <span class="math notranslate nohighlight">\(f({\bf x})\)</span>, de <span class="math notranslate nohighlight">\(\mathbb{R}^n \to \mathbb{R}\)</span>, un punto <span class="math notranslate nohighlight">\({\bf x}_0\)</span> é <strong>extremo</strong> ou <strong>crítico</strong> se o seu gradiente é nulo, <span class="math notranslate nohighlight">\(\nabla f ({\bf x}_0) = {\bf 0}\)</span>.</p>
<p>Dicimos que un punto extremo é <strong>un mínimo local</strong> se todos os puntos dentro dunha bola de tamaño <span class="math notranslate nohighlight">\(\delta\)</span>, centrada en <span class="math notranslate nohighlight">\({\bf x}_0\)</span> teñen un valor da función menor ou igual ao de <span class="math notranslate nohighlight">\({\bf x} _0 \)</span></p>
<div class="math notranslate nohighlight">
\[
 {\bf x} \; / \, \parallel {\bf x} - {\bf x}_0 \parallel \lt \delta \, \Rightarrow f({\bf x}) \ge f({\bf x}_0)
 \]</div>
<p>E do mesmo xeito, será un <strong>máximo local</strong> se:</p>
<div class="math notranslate nohighlight">
\[
 {\bf x} \; / \, \parallel {\bf x} - {\bf x}_0 \parallel \lt \delta \, \Rightarrow f({\bf x}) \le f({\bf x}_0)
 \]</div>
<p>Finalmente, é <strong>un punto de sela</strong> se en cada bóla centrada en <span class="math notranslate nohighlight">\({\bf x}_0\)</span>, hai puntos dentro da bola para os cales o valor da función é maior e outros menores que o valor no punto crítico.</p>
<p>O punto extremo é un mínimo, se todos os <strong>autovalores</strong> , <span class="math notranslate nohighlight">\({\lambda_i, \, i=1, \dots, n }\)</span>, da súa <strong>matriz hessiana</strong> , <span class="math notranslate nohighlight">\({\bf H}({\bf x_0})\)</span>, son positivos; é un máximo se todos son negativos; e é un punto de sela se uns son negativos e outros positivos.</p>
<p>Considera agora unha función escalar <span class="math notranslate nohighlight">\(f(x, y)\)</span> e o punto extremo, <span class="math notranslate nohighlight">\((x_0, y_0)\)</span>, o determinante da matriz Hessiana é negativo. Podes clasificar o extremo, é mínimo, máximo, punto de sela? E se o determinante é positivo?</p>
<p>Un caso particular do anterior acontece para funcións escalares de dúas dimensións, <span class="math notranslate nohighlight">\(f(x,y)\)</span>.
Se temos como matriz Hessiana:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
H = \begin{pmatrix}
H_{xx} &amp; H_{xy} \\
H_{yx} &amp; H_{yy} \\
\end{pmatrix}
\end{split}\]</div>
<p>onde</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(H_{xx} = \frac{\partial^2 f}{\partial x^2}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(H_{xy} = \frac{\partial^2 f}{\partial x \partial y}\)</span> (que é igual a <span class="math notranslate nohighlight">\(H_{yx}\)</span> se <span class="math notranslate nohighlight">\(f\)</span> é suficientemente suave, segundo o teorema de Schwarz)</p></li>
<li><p><span class="math notranslate nohighlight">\(H_{yy} = \frac{\partial^2 f}{\partial y^2}\)</span></p></li>
</ul>
<p>Para analizar a natureza do punto crítico <span class="math notranslate nohighlight">\((x_0, y_0)\)</span>, para o cal <span class="math notranslate nohighlight">\(\nabla f (x_0,y_0)=0\)</span>, necesitamos avaliar a matriz Hessiana nese punto e considerar dous valores clave</p>
<ol class="arabic simple">
<li><p><strong>O determinante da matriz Hessiana</strong> en <span class="math notranslate nohighlight">\((x_0, y_0)\)</span>, denotado como <span class="math notranslate nohighlight">\(\text{det}(H)\)</span>, que é <span class="math notranslate nohighlight">\(H_{xx}H_{yy} - H_{xy}^2\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(H_{xx}\)</span></p></li>
</ol>
<p>A natureza do punto crítico determinase da seguinte maneira:</p>
<ul class="simple">
<li><p><strong>Se <span class="math notranslate nohighlight">\(\text{det}(H) &gt; 0\)</span> e <span class="math notranslate nohighlight">\(H_{xx} &gt; 0\)</span></strong>, a función ten un mínimo local en <span class="math notranslate nohighlight">\((x_0, y_0)\)</span>.</p></li>
<li><p><strong>Se <span class="math notranslate nohighlight">\(\text{det}(H) &gt; 0\)</span> e <span class="math notranslate nohighlight">\(H_{xx} &lt; 0\)</span></strong>, a función ten un máximo local en <span class="math notranslate nohighlight">\((x_0, y_0)\)</span>.</p></li>
<li><p><strong>Se <span class="math notranslate nohighlight">\(\text{det}(H) &lt; 0\)</span></strong>, o punto é un punto de sela.</p></li>
<li><p><strong>Se <span class="math notranslate nohighlight">\(\text{det}(H) = 0\)</span></strong>, a proba é inconclusiva.</p></li>
</ul>
<p>O motivo é que <span class="math notranslate nohighlight">\(\text{det}(H)=\lambda_1\lambda_2\)</span>, é dicir, o produto dos autovalores. Se o determinante é negativo sabemos que o signo dos autovalores é o mesmo, se é positivo ten que ser igual. O motivo de usar <span class="math notranslate nohighlight">\(H_{xx}\)</span> como referencia vén do <a class="reference external" href="https://en.wikipedia.org/wiki/Sylvester%27s_criterion">criterio de Sylvester</a>.</p>
<a class="reference internal image-reference" href="https://pbs.twimg.com/media/GHRXJC5WwAAEYpS?format=jpg&amp;name=small"><img alt="https://pbs.twimg.com/media/GHRXJC5WwAAEYpS?format=jpg&amp;name=small" class="align-center" src="https://pbs.twimg.com/media/GHRXJC5WwAAEYpS?format=jpg&amp;name=small" style="width: 400px;" /></a>
</section>
</section>
<section id="minimos-e-maximos-condicionais">
<h2>Mínimos e máximos condicionais<a class="headerlink" href="#minimos-e-maximos-condicionais" title="Permalink to this heading">#</a></h2>
<p>Considera o caso de que queremos calcular os extremos dunha función escalar, <span class="math notranslate nohighlight">\(f({\bf x})\)</span>, pero non en todo o seu dominio, senón nunha parte del. Neste caso fálase de <strong>extremos condicionados</strong> .</p>
<p>Por exemplo, sexa a función: <span class="math notranslate nohighlight">\(f(x, y) = x^2 - y^2\)</span>, e queremos calcular os seus extremos no círculo de raio unitario, é dicir, nos puntos que satisfan <span class="math notranslate nohighlight">\(x^ 2 + y ^2 = \)</span>1.</p>
<p>A seguinte cela debuxa os conxuntos de nivel da función e do círculo. Como podes ver, parametrizamos a circunferencia en función de <span class="math notranslate nohighlight">\(t\)</span> que toma os valores en <span class="math notranslate nohighlight">\([0, 2 \pi)\)</span>.</p>
<ul class="simple">
<li><p>Podes identificar os puntos extremos da función ao longo da circunferencia?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span>   <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="o">*</span><span class="n">y</span>
<span class="n">xt</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span>    <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">yt</span>  <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span>    <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">gf</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
<span class="n">gf</span><span class="o">.</span><span class="n">line2d</span><span class="p">(</span><span class="n">xt</span><span class="p">,</span> <span class="n">yt</span><span class="p">,</span> <span class="n">trange</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="n">newfig</span> <span class="o">=</span> <span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/25b64e7965cd333963f2e2787d3e36288aa7ac426fbc105f8001155d5bba2e02.png" src="../_images/25b64e7965cd333963f2e2787d3e36288aa7ac426fbc105f8001155d5bba2e02.png" />
</div>
</div>
<p>Imos debuxar o gradiente da función nun punto determinado, que como sabemos nos indica a dirección na que a función experimenta o máximo cambio.</p>
<div class="math notranslate nohighlight">
\[
f(x, y) = x^2 - y^2 \, \Rightarrow \nabla f(x, y) = (2x, 2y)
\]</div>
<p><em>Considera</em> primeiro o valor <span class="math notranslate nohighlight">\(t = 3 \pi/4\)</span>, que nos dá o punto <span class="math notranslate nohighlight">\(\left( -1/\sqrt{2}, 1/\sqrt{2} \right)\)</span>.</p>
<p>Se quixeramos dirixirnos nunha dirección na que a función aumentase sen saír do círculo, só poderiamos movernos cara á esquerda (como se a pendiente tirase dun coche que só puidese moverse polo círculo), pero ata cando?</p>
<p><em>Considera</em> agora o valor <span class="math notranslate nohighlight">\(t = \pi\)</span>, este é o punto <span class="math notranslate nohighlight">\((-1, 0)\)</span>. O gradiente alí é radial, se queremos permanecer no círculo, entón non hai dirección que nos permita facelo e que á súa vez nos permita aumentar o valor da función. Acadamos o máximo condicional da función.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t0</span>  <span class="o">=</span> <span class="mf">3.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span>
<span class="n">fpx</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="p">:</span>  <span class="mi">2</span><span class="o">*</span><span class="n">x</span>
<span class="n">fpy</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span>
<span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">xt</span><span class="p">(</span><span class="n">t0</span><span class="p">),</span> <span class="n">yt</span><span class="p">(</span><span class="n">t0</span><span class="p">)</span>
<span class="n">gf</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
<span class="n">gf</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span>
<span class="n">gf</span><span class="o">.</span><span class="n">line2d</span><span class="p">(</span><span class="n">xt</span><span class="p">,</span> <span class="n">yt</span><span class="p">,</span> <span class="n">trange</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="n">newfig</span> <span class="o">=</span> <span class="kc">False</span><span class="p">);</span>
<span class="n">gf</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">fpx</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="n">fpy</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">);</span> <span class="c1"># nabla f</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d6c51e31028c4b69cdb1231fd27fdfc49d2677c4073497c4a8bc2b98b43f8369.png" src="../_images/d6c51e31028c4b69cdb1231fd27fdfc49d2677c4073497c4a8bc2b98b43f8369.png" />
</div>
</div>
<p>Se observas, o extremo da función coincide no punto para o cal o gradiente é <em>ortogonal</em> ao círculo.</p>
<p>Podemos dar a circunferencia como o conxunto de nivel dunha función, (con <span class="math notranslate nohighlight">\(c= 1\)</span>), simplemente:</p>
<div class="math notranslate nohighlight">
\[
 g(x, y) = x^2 + y^2 = c
 \]</div>
<p>e sabemos que o gradiente desta función será sempre <em>ortogonal</em> ao conxunto de nivel.</p>
<p>Entón o punto extremo, <span class="math notranslate nohighlight">\((x_0, y_0)\)</span>, os dous gradientes, o da función e o da condición de conxunto de nivel, deben ser paralelos, é dicir, proporcionais:</p>
<div class="math notranslate nohighlight">
\[
 \nabla f (x_0, y_0) = \lambda \nabla g(x_0, y_0)
 \]</div>
<p>onde <span class="math notranslate nohighlight">\(\lambda\)</span> é un valor de proporcionalidade.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t0</span>  <span class="o">=</span> <span class="mf">3.</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span>
<span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">xt</span><span class="p">(</span><span class="n">t0</span><span class="p">),</span> <span class="n">yt</span><span class="p">(</span><span class="n">t0</span><span class="p">)</span>
<span class="n">g</span>   <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="o">*</span><span class="n">y</span>
<span class="n">gpx</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="p">:</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span>
<span class="n">gpy</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="p">:</span> <span class="mi">2</span><span class="o">*</span><span class="n">y</span>
<span class="n">gf</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
<span class="n">gf</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span>
<span class="n">gf</span><span class="o">.</span><span class="n">line2d</span><span class="p">(</span><span class="n">xt</span><span class="p">,</span> <span class="n">yt</span><span class="p">,</span> <span class="n">trange</span><span class="o">=</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="n">newfig</span> <span class="o">=</span> <span class="kc">False</span><span class="p">);</span>
<span class="n">gf</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">fpx</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="n">fpy</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">);</span> <span class="c1"># nabla f3</span>
<span class="n">gf</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">gpx</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="n">gpy</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">);</span> <span class="c1"># nabla g</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/7752f747ebdfaccb867ae811bf878bc01ccffe7e2d9a4113f3b19d74c908ec5a.png" src="../_images/7752f747ebdfaccb867ae811bf878bc01ccffe7e2d9a4113f3b19d74c908ec5a.png" />
</div>
</div>
<section id="multiplicadores-de-lagrange">
<h3>Multiplicadores de Lagrange<a class="headerlink" href="#multiplicadores-de-lagrange" title="Permalink to this heading">#</a></h3>
<p>Sexa unha función escalar, <span class="math notranslate nohighlight">\(f({\bf x})\)</span>, o extremo, <span class="math notranslate nohighlight">\({\bf x_0}\)</span> desa función, onde <span class="math notranslate nohighlight">\({\bf x}_0\)</span> pertence aos conxuntos de nivel dados por <span class="math notranslate nohighlight">\(g( {\bf x}) = c\)</span>, cumpre que:</p>
<div class="math notranslate nohighlight">
\[
 \nabla f ({\bf x}_0) = \lambda \nabla g ({\bf x}_0)
 \]</div>
<p>onde <span class="math notranslate nohighlight">\(\lambda\)</span> é un factor de proporcionalidade, chamado <strong>multiplicador de Lagrange</strong> .</p>
<p><em>Exercicio</em> : Calcula os extremos condicionais da función <span class="math notranslate nohighlight">\(f(x, y)= x^2 - y^2\)</span> no círculo de raio unitario</p>
<div class="math notranslate nohighlight">
\[
 \nabla f (x, y) = (2x, -2y)
 \]</div>
<p>Podemos dar a condición de:</p>
<div class="math notranslate nohighlight">
\[
 g(x, y) = x^2 + y^2 = 1
 \]</div>
<p>A condición de Lagrange:</p>
<div class="math notranslate nohighlight">
\[
\nabla f (x_0, y_0) = \lambda \nabla g (x_0, y_0) \; \Rightarrow \, (2x_0, -2y_0) = \lambda (2x_0, 2y_0)
\]</div>
<p>Da primeira condición <span class="math notranslate nohighlight">\(2 x_0 = \lambda 2 x_0\)</span>, obtemos <span class="math notranslate nohighlight">\(\lambda = 1\)</span>; pero para que se cumpra a segunda ecuación <span class="math notranslate nohighlight">\(-2 y_0 = \lambda 2 y_0\)</span>, como <span class="math notranslate nohighlight">\(\lambda = 1\)</span>, entón <span class="math notranslate nohighlight">\(y_0 = 0\)</span>.</p>
<p>Só hai dous puntos no círculo con <span class="math notranslate nohighlight">\(y_0 = 0\)</span> que son <span class="math notranslate nohighlight">\((-1, 0)\)</span> e <span class="math notranslate nohighlight">\((1, 0)\)</span>. En ambos, cúmprese a condición de Lagrange. Son polo tanto extremos condicionados.</p>
<p>Da segunda condición <span class="math notranslate nohighlight">\(2 y_0 = - \lambda 2 y_0\)</span>, obtemos <span class="math notranslate nohighlight">\(\lambda = -1\)</span>; pero para o primeiro que se cumpra neste caso, <span class="math notranslate nohighlight">\(2 x_0 = 2 \lambda x_0\)</span>, como <span class="math notranslate nohighlight">\(\lambda = -1\)</span>, entón <span class="math notranslate nohighlight">\(x_0 = 0\)</span>.</p>
<p>Só hai dous puntos no círculo con <span class="math notranslate nohighlight">\(x_0 = 0\)</span> que son: <span class="math notranslate nohighlight">\((0, 1)\)</span> e <span class="math notranslate nohighlight">\((0, -1)\)</span>. Tamén son extremos condicionados</p>
<p>A función en <span class="math notranslate nohighlight">\((-1, 0)\)</span> e <span class="math notranslate nohighlight">\((1, 0)\)</span> vale <span class="math notranslate nohighlight">\(1\)</span>. Mentres que en <span class="math notranslate nohighlight">\((0, 1)\)</span> e <span class="math notranslate nohighlight">\((0, -1)\)</span> vale <span class="math notranslate nohighlight">\(-1\)</span>. Os dous primeiros son máximos condicionais e os dous últimos son mínimos condicionais.</p>
<p><em>Verifica</em> : que é correcta na cela anterior, colocando <span class="math notranslate nohighlight">\(t = 0, \pi/2, \pi, 3 \pi/2\)</span>, e observe como os gradientes se aliñan e coinciden cos valores máximo e mínimo que o célula pode levar.función na circunferencia.</p>
<p>Unha alternativa, válida neste caso pero complicada noutros, pode ser construir</p>
<div class="math notranslate nohighlight">
\[
h(x) = f(x,y(x))= x^2-(1-x^2) = 1 - 2x^2
\]</div>
<p>e búscar os puntos extremos de <span class="math notranslate nohighlight">\(h(x)\)</span>. Se o facemos, <span class="math notranslate nohighlight">\(h'(x)=-2x=0 \Rightarrow x=0\)</span>. O que nos da os puntos <span class="math notranslate nohighlight">\((0, 1)\)</span> e <span class="math notranslate nohighlight">\((0, -1)\)</span>. Se construímos <span class="math notranslate nohighlight">\(h(y)=f(y(x),x)\)</span> e a minimizamos chegamos aos outros dous: <span class="math notranslate nohighlight">\((-1, 0)\)</span> e <span class="math notranslate nohighlight">\((1, 0)\)</span>.</p>
</section>
</section>
<section id="ainda-hai-mais">
<h2>Aínda hai máis!<a class="headerlink" href="#ainda-hai-mais" title="Permalink to this heading">#</a></h2>
<section id="joseph-louis-lagrange">
<h3>Joseph Louis Lagrange<a class="headerlink" href="#joseph-louis-lagrange" title="Permalink to this heading">#</a></h3>
<p>Lagrange foi un dos grandes matemáticos e físicos dos séculos XVIII e principios do XIX. Era un home da súa época, un italiano do norte que percorreu a Europa do seu tempo, e que foi profesor na gran escola “École Polytechnique”, recentemente fundada por Napoleón. Debémoslle moitas contribucións, entre elas a reformulación da mecánica newtoniana. Aquí está a súa entrada na Wikipedia: <a class="reference external" href="https://en.wikipedia.org/wiki/Joseph-Louis_Lagrange">JL Lagrange</a></p>
<a class="reference internal image-reference" href="https://www.biografiasyvidas.com/biografia/l/fotos/lagrange.jpg"><img alt="https://www.biografiasyvidas.com/biografia/l/fotos/lagrange.jpg" class="align-center" src="https://www.biografiasyvidas.com/biografia/l/fotos/lagrange.jpg" style="width: 300px;" /></a>
</section>
<section id="principio-de-minima-accion">
<h3>Principio de mínima acción<a class="headerlink" href="#principio-de-minima-accion" title="Permalink to this heading">#</a></h3>
<p>Os máximos e os mínimos xogan un papel fundamental na Física. De feito, a mecánica clásica (e tamén moderna) pode formularse en función do <a class="reference external" href="https://en.wikipedia.org/wiki/Principle_of_least_action">principio de mínima acción</a> , que nos di que a dinámica dun sistema físico está rexida pola busca da menor acción, que se define matemáticamente como a integral dun termo chamado <strong>Lagrangiano</strong> .</p>
<p>Este principio foi declarado por primeira vez polo físico francés Maupertius no século XVIII, e na súa versión moderna, no século XX polo físico e profesor estadounidense Richard <strong>Feynman</strong> . Aquí tes unha ligazón a unha das súas famosas <a class="reference external" href="http://www.feynmanlectures.caltech.edu/II_19.html">clases</a> e á súa entrada na Wikipedia, <a class="reference external" href="https://en.wikipedia.org/wiki/Richard_Feynman">Feynman</a></p>
<a class="reference internal image-reference" href="https://visit.cern/sites/default/files/inline-images/postcard_formula_500.png"><img alt="https://visit.cern/sites/default/files/inline-images/postcard_formula_500.png" class="align-center" src="https://visit.cern/sites/default/files/inline-images/postcard_formula_500.png" style="width: 300px;" /></a>
</section>
<section id="o-metodo-dos-minimos-cadrados">
<h3>O método dos mínimos cadrados<a class="headerlink" href="#o-metodo-dos-minimos-cadrados" title="Permalink to this heading">#</a></h3>
<p>Os mínimos e os máximos tamén xogan un papel fundamental na estimación de parámetros e observables.</p>
<p>Probablemente utilizastes o método dos mínimos cadrados nas técnicas experimentais de laboratorio para axustar os datos a unha liña recta.</p>
<p>Como sabedes, a Natureza ten un comportamento probabilístico e as nosas medicións <em>sempre</em> están suxeitas a incertezas.</p>
<p>No método dos mínimos cadrados, a distancia (cadrada) dos valores medidos calcúlase contra o valor dunha función de hipótese, por exemplo a liña, que depende de varios parámetros (no caso da liña, os parámetros son os pendente, <span class="math notranslate nohighlight">\(a\)</span>, e o limiar na orixe, <span class="math notranslate nohighlight">\(b\)</span>). Estimamos estes parámetros e as súas incertezas calculando o mínimo da suma das distancias ao cadrado. Chamamos a esta función, <span class="math notranslate nohighlight">\(\chi^2\)</span>, que no caso de axustarse a unha liña, é unha función escalar de dúas variables, <span class="math notranslate nohighlight">\(a, b\)</span>.</p>
<p>É dicir, determinamos os parámetros do noso modelo como aqueles que fan que a suma das distancias cadradas dos datos con respecto ao modelo sexa o máis pequena posible.</p>
<p>No caso da liña recta:</p>
<p>Sexa unha mostra de datos <span class="math notranslate nohighlight">\({(x_i, y_u), \; i = 1, \dots, n}\)</span>, con erros <span class="math notranslate nohighlight">\(\sigma_i = \sigma\)</span>,</p>
<p>que se distribúen ao longo dunha liña recta. Sabemos que este ten dous parámetros, <span class="math notranslate nohighlight">\(a\)</span>, a pendente e <span class="math notranslate nohighlight">\(b\)</span>, o limiar na orixe.</p>
<div class="math notranslate nohighlight">
\[
 y(x \, | \, a, b) = a \, x + b
 \]</div>
<p>e construímos a función escalar <span class="math notranslate nohighlight">\(\chi^2(a, b)\)</span> como:</p>
<div class="math notranslate nohighlight">
\[
 \chi^2(a, b) = \frac{1}{n-2} \, \sum _{i=1}^n \frac{(y_i - y(x_i | a, b))^2} { \sigma^2} \
 = \frac{1}{n-2} \, \sum _{i=1}^n \frac{(y_i - a \, x_i - b)^2}{\sigma^2}
 \]</div>
<p>onde o termo denominador, <span class="math notranslate nohighlight">\(n-2\)</span>, corresponde aos graos de liberdade que son o número de datos, <span class="math notranslate nohighlight">\(n\)</span>, menos o número de parámetros, 2 neste caso (para <span class="math notranslate nohighlight">\(a, b\)</span>).</p>
<p>E estimamos os parámetros <span class="math notranslate nohighlight">\(\hat{a}, \hat{b}\)</span> como os que minimizan o <span class="math notranslate nohighlight">\(\chi^2\)</span></p>
<div class="math notranslate nohighlight">
\[
 (\hat{a}, \hat{b}) \;\;\; / \;\; \chi^2(\hat{a}, \hat{b}) = \mathrm{min}(\chi^2(a, b))
 \]</div>
<p>As seguintes celas mostran o axuste a unha liña de datos simulada.</p>
<p>Primeiro xeramos unha mostra de datos aleatorios <span class="math notranslate nohighlight">\({ (x_i, y_i), \; i= 1, \dots, n }\)</span>, ao longo dunha liña recta, cada un coa mesma incerteza <span class="math notranslate nohighlight">\(\sigma_i = \sigma\)</span>. Despois estimamos os parámetros, <span class="math notranslate nohighlight">\((\hat{a}, \hat{b})\)</span>, utilizando o método dos mínimos cadrados.</p>
<p>Na figura debúxanse os puntos co seu erro, a recta verdadeira e a recta estimada.</p>
<p><em>Explorar</em> Cambia o número de puntos ou os parámetros verdadeiros para ver como cambia o axuste.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.stats</span>    <span class="k">as</span> <span class="nn">stats</span>
<span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="k">as</span> <span class="nn">optimize</span>

<span class="k">def</span> <span class="nf">experiment</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">xrange</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)):</span>
    <span class="n">x0</span><span class="p">,</span> <span class="n">xf</span> <span class="o">=</span> <span class="n">xrange</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="p">(</span><span class="n">xf</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span><span class="o">*</span><span class="n">stats</span><span class="o">.</span><span class="n">uniform</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span> <span class="o">=</span> <span class="n">npoints</span><span class="p">)</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">xs</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">scale</span> <span class="o">=</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="n">npoints</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">lsq_fit</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">aguess</span> <span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bguess</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">):</span>
    <span class="n">fres</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">pars</span><span class="p">:</span> <span class="p">(</span><span class="n">ys</span> <span class="o">-</span> <span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">xs</span> <span class="o">-</span> <span class="n">pars</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">sigma</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">leastsq</span><span class="p">(</span><span class="n">fres</span><span class="p">,</span> <span class="p">(</span><span class="n">aguess</span><span class="p">,</span> <span class="n">bguess</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="k">def</span> <span class="nf">chisq</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">chi2</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)):</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="p">(</span><span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">a</span><span class="o">*</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="n">sigma</span>
        <span class="n">chi2</span> <span class="o">+=</span> <span class="n">dx</span><span class="o">*</span><span class="n">dx</span>
    <span class="k">return</span> <span class="n">chi2</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ys</span><span class="p">)</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">atrue</span><span class="p">,</span> <span class="n">btrue</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">npoints</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mi">100</span>
<span class="n">xrange</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">xs</span><span class="p">,</span> <span class="n">ys</span>     <span class="o">=</span> <span class="n">experiment</span><span class="p">(</span><span class="n">atrue</span><span class="p">,</span> <span class="n">btrue</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">xrange</span> <span class="o">=</span> <span class="n">xrange</span><span class="p">)</span>
<span class="n">ahat</span><span class="p">,</span> <span class="n">bhat</span> <span class="o">=</span> <span class="n">lsq_fit</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">sigma</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">xrange</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">bhat</span>  <span class="o">+</span> <span class="n">ahat</span> <span class="o">*</span><span class="n">ts</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;lsq-fit&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ts</span><span class="p">,</span> <span class="n">btrue</span> <span class="o">+</span> <span class="n">atrue</span><span class="o">*</span><span class="n">ts</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span> <span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;true&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;a = &#39;</span><span class="p">,</span> <span class="n">ahat</span><span class="p">,</span> <span class="s1">&#39;b = &#39;</span><span class="p">,</span> <span class="n">bhat</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>a =  1.0135846229910064 b =  -0.024836382760009514
</pre></div>
</div>
<img alt="../_images/e4c17a29418c28b81d3361afc6a4b9c3cb7fc6b33a170902f875a1a8da0c2862.png" src="../_images/e4c17a29418c28b81d3361afc6a4b9c3cb7fc6b33a170902f875a1a8da0c2862.png" />
</div>
</div>
<p>Na seguinte cela, debuxamos os conxuntos de nivel da función <span class="math notranslate nohighlight">\(\chi^2(a, b)\)</span>.</p>
<p>Podes ver para este experimento que os valores estimados dannos o mínimo de <span class="math notranslate nohighlight">\(\chi^2\)</span> e tamén podes ver os conxuntos de nivel en diferentes valores, que, estando preto do mínimo, deben ser elipses e que nos dan unha estimación da incerteza dos parámetros <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>. O valor verdadeiro é o punto negro, mentres que o valor estimado é o punto vermello.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xchi</span> <span class="o">=</span>  <span class="n">chisq</span><span class="p">(</span><span class="n">ahat</span><span class="p">,</span> <span class="n">bhat</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;chisq &#39;</span><span class="p">,</span> <span class="n">xchi</span><span class="p">)</span>
<span class="n">gf</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">chisq</span><span class="p">,</span> <span class="n">contours</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">xrange</span> <span class="o">=</span> <span class="p">(</span><span class="n">ahat</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ahat</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">zlim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
           <span class="n">yrange</span> <span class="o">=</span> <span class="p">(</span><span class="n">bhat</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">bhat</span> <span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="n">gf</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ahat</span><span class="p">,</span> <span class="n">bhat</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">);</span> <span class="n">gf</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">atrue</span><span class="p">,</span> <span class="n">btrue</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">);</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">();</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">),</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>chisq  0.9768798168345345
</pre></div>
</div>
<img alt="../_images/6328d149e384585ce8a5f778483511d9052f2884fbebc108cdb7b528d2efcc84.png" src="../_images/6328d149e384585ce8a5f778483511d9052f2884fbebc108cdb7b528d2efcc84.png" />
</div>
</div>
</section>
<section id="as-redes-neuronais">
<h3>As redes neuronais<a class="headerlink" href="#as-redes-neuronais" title="Permalink to this heading">#</a></h3>
<p>As redes neuronais son algoritmos matemáticos que <em>aprenden</em> a identificar patróns e clasificar mostras. O concepto leva aí desde mediados do século pasado, pero comezou a despegar desde <span class="math notranslate nohighlight">\(\sim\)</span>2010. Por exemplo, algo máis dunha década Google desenvolveu unha poderosa rede neuronal que distinguía as imaxes de gatos e cans. Desde entón as redes neuronais xa forman parate das nas nosas vidas.</p>
<p>As redes neuronais toman o seu nome pola súa semellanza co noso sistema nervioso.</p>
<p>Unha rede está formada por neuronas que están dispostas en capas. A figura da seguinte cela mostra un esquema dunha rede neuronal. Cada neurona ten un conxunto de entradas e unha única saída. Matemáticamente, cada neurona é unha función escalar, <span class="math notranslate nohighlight">\(\mathbb{R}^n \to \mathbb{R}\)</span>, onde <span class="math notranslate nohighlight">\(n\)</span> é o número de entradas. A última capa da rede adoita ser unha única neurona e a súa saída é a resposta da rede. Matemáticamente, toda a rede é unha función escalar <span class="math notranslate nohighlight">\(\mathbb{R}^N \to \mathbb{R}\)</span>, onde <span class="math notranslate nohighlight">\(N\)</span> é o número de entradas na primeira capa.</p>
<p>Nestes vídeos podes atopar unha sinxela introdución ás redes neuronais <a class="reference external" href="https://www.youtube.com/watch?v=aircAruvnKk">[&gt;]</a> e aos seus métodos de adestramento <a class="reference external" href="https://www.youtube.com/watch?v=IHZwWFHWa-w">[&gt;]</a></p>
<p><strong>Esquema dunha rede neuronal</strong></p>
<p>As neuronas da primeira capa reciben os datos do mundo “exterior” e a neurona da última capa dá a resposta da rede.</p>
<a class="reference internal image-reference" href="../_images/NN.png"><img alt="../_images/NN.png" src="../_images/NN.png" style="width: 400px;" /></a>
<p>Podemos considerar as capas intermedias <em>ocultas</em> .</p>
<p>A función escalar da neurona adoita ser un sigmoide.</p>
<p>O sigmoide ten como parámetros un vector n-dimensional, <span class="math notranslate nohighlight">\({\bf a}\)</span>, e un escalar, <span class="math notranslate nohighlight">\(b\)</span>.</p>
<p>A súa forma é a seguinte:</p>
<div class="math notranslate nohighlight">
\[
 u( {\bf x} \, | \, {\bf a}, b ) = \frac{1}{1 + e^{-{\bf ax} - b}}
 \]</div>
<p>Ten en conta que é unha función escalar <span class="math notranslate nohighlight">\(\mathbb{R}^n \to \mathbb{R}\)</span> e que o seu valor está incluído no intervalo <span class="math notranslate nohighlight">\([0, 1]\)</span></p>
<p><em>Explorar:</em> modifica o coeficiente <span class="math notranslate nohighlight">\(a\)</span> na seguinte cela e mira como cambia a resposta do sigmoide.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">2.</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="o">*</span><span class="n">x</span> <span class="o">-</span> <span class="n">b</span><span class="p">))</span>
<span class="n">gf</span><span class="o">.</span><span class="n">fun1d</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/af35f96641eae5d5f26c1e904e649bf33b7a073e3fdf68461d04e9cb2145171b.png" src="../_images/af35f96641eae5d5f26c1e904e649bf33b7a073e3fdf68461d04e9cb2145171b.png" />
</div>
</div>
<p><strong>Como funcionan as redes neuronais?</strong></p>
<p>A través do adestramento, é dicir, minimizando unha función escalar que chamamos erro.</p>
<p>Consideremos o caso da rede neuronal que distingue imaxes de cans e gatos.</p>
<p>Podemos matematizar a imaxe dándoa como un conxunto de píxeles (como se a imaxe fose un mosaico e cada mosaico un <em>píxel</em> ), e o valor de cada píxel correspondería, por exemplo, a un valor de escala de grises se a imaxe está en branco e negro. Polo tanto, convertimos a imaxe nun vector, <span class="math notranslate nohighlight">\({\bf x}\)</span>, que será a entrada para a nosa rede.</p>
<p>A rede terá varias capas con varias neuronas, por exemplo capas <span class="math notranslate nohighlight">\(L\)</span>, con neuronas <span class="math notranslate nohighlight">\(K\)</span> en cada capa, e rematará cunha neurona final. Isto dará un valor entre <span class="math notranslate nohighlight">\([0, 1]\)</span>, 0 corresponderá á imaxe dun gato e 1 á do can.</p>
<p>A rede neuronal é polo tanto en si mesma unha función escalar que, a partir da imaxe inicial <span class="math notranslate nohighlight">\({\bf x}\)</span>, dános unha única resposta <span class="math notranslate nohighlight">\(y({\bf x} | {\bf a}^{lk}, b ^ {lk})\)</span>, onde <span class="math notranslate nohighlight">\({\bf a}^{lk}, b^{lk}\)</span> son os parámetros da neurona na capa <span class="math notranslate nohighlight">\(l\)</span> e na posición <span class="math notranslate nohighlight">\(k\)</span> dentro desa capa. A resposta da rede neuronal é, polo tanto, unha función escalar <span class="math notranslate nohighlight">\(\mathbb{R}^N \to \mathbb{R}\)</span>, sendo <span class="math notranslate nohighlight">\(N\)</span> o número de píxeles das nosas imaxes.</p>
<p>Construímos unha función de erro a partir dunha mostra de imaxes de cans e gatos <span class="math notranslate nohighlight">\({ {\bf x}_i, \; i = 1, \dots, M}\)</span>, onde <span class="math notranslate nohighlight">\(M\)</span> é un número moi grande, e a partir da resposta correcta para cada imaxe  <span class="math notranslate nohighlight">\(\{ y_i, \; i = 1, \dots, M \}\)</span>, onde <span class="math notranslate nohighlight">\(y_i\)</span> será 0 cando a imaxe sexa dun gato e 1 dun can, coa seguinte expresión:</p>
<div class="math notranslate nohighlight">
\[
 E({\bf a}^{lk}, b^{lk}) = \frac{1}{MQ} \, \sum _{i=1}^M (y_i - y({\bf x}_i | {\bf a}^{lk}, b^{lk}))^2
 \]</div>
<p>A función de erro é unha función escalar <span class="math notranslate nohighlight">\(\mathbb{R}^Q \to \mathbb{R}\)</span>, onde <span class="math notranslate nohighlight">\(Q\)</span> é o número total de parámetros de todas as neuronas.</p>
<p>Ten en conta que se a rede sempre acerta, a función de erro sería 0.</p>
<p>No método dos mínimos cadrados, estimamos os parámetros, <span class="math notranslate nohighlight">\((\hat{a}, \hat{b})\)</span> minimizando a función <span class="math notranslate nohighlight">\(\chi^2(a,b)\)</span>, agora determinaremos os parámetros do neuronas, minimizando a función de erro. É dicir, fixaremos os parámetros das neuronas a aqueles cos que a rede comete os menores erros posibles na mostra coa que a adestramos.</p>
<div class="math notranslate nohighlight">
\[
 (\hat{\bf{a}}^{lk}, \hat{b}^{lk}) \;\;\; / \;\; E(\hat{\bf{a}}^{lk}, \hat{b}^{lk}) = \mathrm{min}(E({\bf a}^{lk}, b^{lk} ))
 \]</div>
<p>No exemplo de axuste de mínimos cadrados, a función <span class="math notranslate nohighlight">\(\chi^2(a, b)\)</span> dependía de dous parámetros, e podíamos calculalos analíticamente, pero agora a nosa función de erro <span class="math notranslate nohighlight">\(E({\bf a}^{lk}, b^{lk})\)</span> ten parámetros <span class="math notranslate nohighlight">\(Q\)</span>, que poden ser un número moi grande.</p>
<p>Sería imposible calcular o mínimo analiticamente, pero enxeñeiros, físicos e matemáticos puideron desenvolver unha serie de métodos computacionais moi potentes cos que estimar os parámetros das neuronas minimizando a función de erro. E baséanse en calcular <strong>grandes</strong> e aplicar <strong>a regra da cadea</strong> !</p>
<p>Aquí tedes un vídeo <a class="reference external" href="https://www.youtube.com/watch?v=IHZwWFHWa-w">[&gt;]</a> que o explica.</p>
<p>Unha vez que a rede estea “adestrada” ou “aprendeu” (é dicir, minimizamos a súa función de erro), poderemos amosarlle outras fotos de gatos e cans e para cada un deles, predecirá para o noso asombro se son cans ou gatos. Sexa agora unha imaxe co vector <span class="math notranslate nohighlight">\({\bf x}\)</span>, a resposta da rede virá dada por <span class="math notranslate nohighlight">\(y({\bf x} \, | \, \hat{{\bf a}}^{lk }, \hat{b}^{lk})\)</span></p>
<p><strong>E isto ten que ver coa Física?</strong></p>
<p>Unha morea! Actualmente hai poucas análises en Física de Partículas, por exemplo, onde non se utiliza unha rede neuronal ou un método similar.</p>
<p>Utilízanse para identificar se unha partícula é un electrón ou un muón (o seu irmán máis pesado). Ou se hai un bosón de Higgs nunha interacción ou non. Para decidir se unha interacción é relevante ou ordinaria.</p>
<p>Xa podes imaxinar que as redes neuronais están detrás dalgunhas aplicacións como Facebook, Instagram, Spotify, TikTok e todos os xenios matemáticos que intentan predicir os teus gustos na rede.</p>
<p>Se queres aprender máis sobre as redes neuronais, podes ler este <a class="reference external" href="http://neuralnetworksanddeeplearning.com/index.html">libro en liña</a> e podes experimentar co módulo de Python <a class="reference external" href="https://scikit-learn.org/stable/">scikit-learn</a> .</p>
<p>A seguinte imaxe amosa un evento do detector LHCb, no que traballamos no IGFAE. Empregamos diferentes redes neuronais para diferentes aspectos da análise destes eventos, como a identificación das partículas que o compoñen.</p>
<a class="reference internal image-reference" href="https://cds.cern.ch/record/2151262/files/LHCb7.png"><img alt="https://cds.cern.ch/record/2151262/files/LHCb7.png" src="https://cds.cern.ch/record/2151262/files/LHCb7.png" style="width: 800px;" /></a>
<p><strong>Isto é todo por agora!</strong></p>
</section>
</section>
<section id="apendices">
<h2>Apéndices<a class="headerlink" href="#apendices" title="Permalink to this heading">#</a></h2>
<p>Algo máis complicado!</p>
<p><em>Exercicio</em> : Usa Python e os métodos do módulo scipy para calcular os extremos da función:</p>
<div class="math notranslate nohighlight">
\[
 f(x, y) = \frac{x - y}{ 2 x^2 + 8 y^2 + 3}
 \]</div>
<p>Comeza debuxando a función e as súas curvas de nivel!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">y</span> <span class="o">+</span><span class="mi">3</span><span class="p">)</span>
<span class="n">gf</span><span class="o">.</span><span class="n">graph</span><span class="p">(</span><span class="n">fun</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1e6da6bbb848bfac9128ab4bd47eafeab8d5ef4770231f9b4367dff797aa6da5.png" src="../_images/1e6da6bbb848bfac9128ab4bd47eafeab8d5ef4770231f9b4367dff797aa6da5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gf</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">fun</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/2a8376c04b6cea784694a480906c6fef5226ed26eecc46e8b719fa15007278b1.png" src="../_images/2a8376c04b6cea784694a480906c6fef5226ed26eecc46e8b719fa15007278b1.png" />
</div>
</div>
<p>Dos conxuntos de nivel observamos que hai un mínimo arredor de <span class="math notranslate nohighlight">\((-1, 0)\)</span> e un máximo preto de <span class="math notranslate nohighlight">\((1, 0)\)</span>, e que os eixes de simetría nos extremos coinciden cos eixes de coordenadas.</p>
<p>Neste exercicio é imposible calcular os puntos extremos analíticamente, e temos que utilizar métodos numéricos en Python.</p>
<p>Nas celas seguintes, primeiro calculamos numericamente o punto mínimo e máximo.</p>
<p>Despois empregaremos o cálculo simbólico para calcular as derivadas parciais e segundas, e despois avaliaremos a matriz de Hesse nos puntos extremos.</p>
<p>Finalmente calcularemos numericamente os autovalores e autovectores da matriz de Hesse, e verificaremos que son un máximo e un mínimo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.optimize</span> <span class="k">as</span> <span class="nn">optimize</span>
<span class="kn">import</span> <span class="nn">scipy.linalg</span>   <span class="k">as</span> <span class="nn">linalg</span>
<span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">res1</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">res1</span><span class="o">.</span><span class="n">x</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;punto mínimo &#39;</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span>
<span class="n">fun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">8</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">res2</span> <span class="o">=</span> <span class="n">optimize</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">res2</span><span class="o">.</span><span class="n">x</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;punto máximo &#39;</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>punto mínimo  -1.0954920902489502 0.2738621986560991
punto máximo  1.0954920606202636 -0.27386221675122946
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x y&#39;</span><span class="p">)</span>
<span class="n">fx</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">diff</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">8</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">3</span><span class="p">),</span> <span class="n">x</span><span class="p">)</span>
<span class="n">fy</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">diff</span><span class="p">((</span><span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">8</span><span class="o">*</span><span class="n">y</span><span class="o">*</span><span class="n">y</span><span class="o">+</span><span class="mi">3</span><span class="p">),</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fx &#39;</span><span class="p">,</span> <span class="n">fx</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fy &#39;</span><span class="p">,</span> <span class="n">fy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>fx  -4*x*(x - y)/(2*x**2 + 8*y**2 + 3)**2 + 1/(2*x**2 + 8*y**2 + 3)
fy  -16*y*(x - y)/(2*x**2 + 8*y**2 + 3)**2 - 1/(2*x**2 + 8*y**2 + 3)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fxx</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">fx</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">fxy</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">fx</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">fyy</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">fy</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">fyx</span> <span class="o">=</span> <span class="n">sympy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">fy</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fxx &#39;</span><span class="p">,</span> <span class="n">fxx</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fxy &#39;</span><span class="p">,</span> <span class="n">fxy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fyx &#39;</span><span class="p">,</span> <span class="n">fyx</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;fyy &#39;</span><span class="p">,</span> <span class="n">fyy</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>fxx  32*x**2*(x - y)/(2*x**2 + 8*y**2 + 3)**3 - 8*x/(2*x**2 + 8*y**2 + 3)**2 - 4*(x - y)/(2*x**2 + 8*y**2 + 3)**2
fxy  128*x*y*(x - y)/(2*x**2 + 8*y**2 + 3)**3 + 4*x/(2*x**2 + 8*y**2 + 3)**2 - 16*y/(2*x**2 + 8*y**2 + 3)**2
fyx  128*x*y*(x - y)/(2*x**2 + 8*y**2 + 3)**3 + 4*x/(2*x**2 + 8*y**2 + 3)**2 - 16*y/(2*x**2 + 8*y**2 + 3)**2
fyy  512*y**2*(x - y)/(2*x**2 + 8*y**2 + 3)**3 + 32*y/(2*x**2 + 8*y**2 + 3)**2 - 16*(x - y)/(2*x**2 + 8*y**2 + 3)**2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;punto &#39;</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">)</span>
<span class="n">hxx</span> <span class="o">=</span> <span class="n">fxx</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y0</span><span class="p">)])</span>
<span class="n">hxy</span> <span class="o">=</span> <span class="n">fxy</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y0</span><span class="p">)])</span>
<span class="n">hyx</span> <span class="o">=</span> <span class="n">fyx</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y0</span><span class="p">)])</span>
<span class="n">hyy</span> <span class="o">=</span> <span class="n">fyy</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="n">x0</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y0</span><span class="p">)])</span>
<span class="n">h</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="nb">float</span><span class="p">(</span><span class="n">hxx</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">hxy</span><span class="p">)],</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">hyx</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">hyy</span><span class="p">)]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;hessiana &#39;</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="n">eigvals</span><span class="p">,</span> <span class="n">eigvecs</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;autovalores&#39;</span><span class="p">,</span> <span class="n">eigvals</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;autovector 1 :&#39;</span><span class="p">,</span> <span class="n">eigvecs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;autovector 2 :&#39;</span><span class="p">,</span> <span class="n">eigvecs</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>punto  -1.0954920902489502 0.2738621986560991
hessiana  [[1.52129395e-01 5.62777899e-06]
 [5.62777899e-06 6.08558515e-01]]
autovalores [0.15212939+0.j 0.60855852+0.j]
autovector 1 : [-1.00000000e+00  1.23300174e-05]
autovector 2 : [-1.23300174e-05 -1.00000000e+00]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;punto &#39;</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">)</span>
<span class="n">hxx</span> <span class="o">=</span> <span class="n">fxx</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="n">x1</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y1</span><span class="p">)])</span>
<span class="n">hxy</span> <span class="o">=</span> <span class="n">fxy</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="n">x1</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y1</span><span class="p">)])</span>
<span class="n">hyx</span> <span class="o">=</span> <span class="n">fyx</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="n">x1</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y1</span><span class="p">)])</span>
<span class="n">hyy</span> <span class="o">=</span> <span class="n">fyy</span><span class="o">.</span><span class="n">subs</span><span class="p">([(</span><span class="n">x</span><span class="p">,</span> <span class="n">x1</span><span class="p">),</span> <span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">y1</span><span class="p">)])</span>
<span class="n">h</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="nb">float</span><span class="p">(</span><span class="n">hxx</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">hxy</span><span class="p">)],</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">hyx</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">hyy</span><span class="p">)]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;hessiana &#39;</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
<span class="n">eigvals</span><span class="p">,</span> <span class="n">eigvecs</span> <span class="o">=</span> <span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;autovalores&#39;</span><span class="p">,</span> <span class="n">eigvals</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;autovector 1 :&#39;</span><span class="p">,</span> <span class="n">eigvecs</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;autovector 2 :&#39;</span><span class="p">,</span> <span class="n">eigvecs</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>punto  1.0954920606202636 -0.27386221675122946
hessiana  [[-1.52129403e-01 -5.63252983e-06]
 [-5.63252983e-06 -6.08558504e-01]]
autovalores [-0.1521294+0.j -0.6085585+0.j]
autovector 1 : [ 1.00000000e+00 -1.23404266e-05]
autovector 2 : [1.23404266e-05 1.00000000e+00]
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="tderivadas_coordenadas_cadea.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Cambio de coordenadas e regra da cadea</p>
      </div>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#obxectivos">Obxectivos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#desenvolvemento-de-taylor-de-bf-2-rm-bf-a-orde-de-funcions-escalares">Desenvolvemento de Taylor de <span class="math notranslate nohighlight">\(\bf 2^{\rm \bf a}\)</span> orde de funcións escalares.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#revision-dos-conceptos-de-extremos-minimos-e-maximos">Revisión dos conceptos de extremos, mínimos e máximos.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#igualdade-de-derivadas-segundas-cruzadas">Igualdade de derivadas segundas cruzadas</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#expansion-de-taylor-de-segunda-orde-de-funcions-escalares">Expansión de Taylor de segunda orde de funcións escalares</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimos-e-maximos-das-funcions-escalares">Mínimos e máximos das funcións escalares</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clasificacion-de-puntos-extremos">Clasificación de puntos extremos</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minimos-e-maximos-para-funcions-escalares-de-varias-dimensions">Mínimos e máximos para funcións escalares de varias dimensións</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#minimos-e-maximos-condicionais">Mínimos e máximos condicionais</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiplicadores-de-lagrange">Multiplicadores de Lagrange</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ainda-hai-mais">Aínda hai máis!</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#joseph-louis-lagrange">Joseph Louis Lagrange</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#principio-de-minima-accion">Principio de mínima acción</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#o-metodo-dos-minimos-cadrados">O método dos mínimos cadrados</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#as-redes-neuronais">As redes neuronais</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#apendices">Apéndices</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By José Ángel Hernando Morata, X. Cid Vidal
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright USC - J.A. Hernando, X. Cid Vidal - 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>